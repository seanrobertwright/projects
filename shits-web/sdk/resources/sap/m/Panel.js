/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['./library','sap/ui/core/Control','sap/ui/core/IconPool','sap/ui/Device','./PanelRenderer','sap/m/Button'],function(l,C,I,D,P,B){"use strict";var a=l.PanelAccessibleRole;var b=l.BackgroundDesign;var c=l.ButtonType;var d=C.extend("sap.m.Panel",{metadata:{library:"sap.m",properties:{headerText:{type:"string",group:"Data",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"auto"},expandable:{type:"boolean",group:"Appearance",defaultValue:false},expanded:{type:"boolean",group:"Appearance",defaultValue:false},expandAnimation:{type:"boolean",group:"Behavior",defaultValue:true},backgroundDesign:{type:"sap.m.BackgroundDesign",group:"Appearance",defaultValue:b.Translucent},accessibleRole:{type:"sap.m.PanelAccessibleRole",group:"Accessibility",defaultValue:a.Form}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"},headerToolbar:{type:"sap.m.Toolbar",multiple:false},infoToolbar:{type:"sap.m.Toolbar",multiple:false}},events:{expand:{parameters:{expand:{type:"boolean"},triggeredByInteraction:{type:"boolean"}}}},dnd:{draggable:true,droppable:true},designtime:"sap/m/designtime/Panel.designtime"}});d.prototype.init=function(){this._bInteractiveExpand=false;this.data("sap-ui-fastnavgroup","true",true);};d.prototype.onThemeChanged=function(){this._setContentHeight();};d.prototype.setExpanded=function(e){if(e===this.getExpanded()){return this;}this.setProperty("expanded",e,true);if(!this.getExpandable()){return this;}this._toggleExpandCollapse();this._toggleButtonIcon(e);this.fireExpand({expand:e,triggeredByInteraction:this._bInteractiveExpand});this._bInteractiveExpand=false;return this;};d.prototype.onBeforeRendering=function(){if(this.getExpandable()&&!this.oButtonCollapsed){this.oButtonCollapsed=this._createButton();}if(this.oButtonCollapsed){this._getButton().$().attr("aria-expanded",this.getExpanded());}if(D.browser.msie||D.browser.edge){this._updateButtonAriaLabelledBy();}if(sap.ui.getCore().getConfiguration().getAccessibility()){this.$().attr("role",this.getAccessibleRole().toLowerCase());}};d.prototype.onAfterRendering=function(){var $=this.$(),e,p=this.getDomRef("content");var o=this.getDomRef();if(o){o.style.width=this.getWidth();var h=this.getHeight();o.style.height=h;if(parseFloat(h)!=0){o.querySelector(".sapMPanelContent").style.height=h;}}this._setContentHeight();if(this.getExpandable()){e=this.oButtonCollapsed.$();p&&e.attr("aria-controls",p.id);if(this.getExpanded()){e.attr("aria-expanded","true");}else{$.children(".sapMPanelExpandablePart").css("display","none");e.attr("aria-expanded","false");}}};d.prototype.exit=function(){if(this.oButtonCollapsed){this.oButtonCollapsed.destroy();this.oButtonCollapsed=null;}};d.prototype._createButton=function(){var t=this,s=I.getIconURI("slim-arrow-right"),T=sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PANEL_ICON"),o;o=new B(t.getId()+"-CollapsedImg",{icon:s,tooltip:T,type:c.Transparent,press:function(){t._bInteractiveExpand=true;t.setExpanded(!t.getExpanded());}});this.addDependent(o);return o;};d.prototype._getButton=function(){return this.oButtonCollapsed;};d.prototype._toggleButtonIcon=function(i){var o=this._getButton(),s=i?I.getIconURI("slim-arrow-down"):I.getIconURI("slim-arrow-right");o&&o.setIcon(s);};d.prototype._setContentHeight=function(){var A,t=this.getDomRef(),p=t&&t.querySelector(".sapMPanelContent");if(this.getHeight()==="auto"||!p){return;}A='calc('+this.getHeight()+' - '+p.offsetTop+'px)';p.style.height=A;};d.prototype._toggleExpandCollapse=function(){var o={};if(!this.getExpandAnimation()){o.duration=0;}this.$().children(".sapMPanelExpandablePart").slideToggle(o);};d.prototype._updateButtonAriaLabelledBy=function(){var L,A,f;if(!this.oButtonCollapsed){return;}if(this.getAccessibleRole()===a.Form){f=true;}L=this._getLabellingElementId();A=this.oButtonCollapsed.getAriaLabelledBy();if(L&&A.indexOf(L)===-1){this.oButtonCollapsed.removeAllAssociation("ariaLabelledBy");!f&&this.oButtonCollapsed.addAriaLabelledBy(L);}};d.prototype._getLabellingElementId=function(){var h=this.getHeaderToolbar(),H=this.getHeaderText(),i=null;if(h){i=h.getTitleId();}else if(H){i=this.getId()+"-header";}return i;};return d;});
