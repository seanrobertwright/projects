/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/m/PlanningCalendarRow','sap/m/Button','sap/ui/core/date/UniversalDate'],function(P,B,U){"use strict";var a=P.extend("sap.f.PlanningCalendarInCardRow",{metadata:{library:"sap.m",properties:{visibleAppointmentsCount:{type:"int",group:"Data",defaultValue:2}}}});a.prototype.exit=function(){P.prototype.exit.call(this,arguments);if(this._oMoreAppsButton){this._oMoreAppsButton.destroy();this._oMoreAppsButton=null;}};a.prototype._calculateVisibleAppointments=function(s,S){var n=new U(),t=new U(n.getFullYear(),n.getMonth(),n.getDate()),c=U.getInstance(new Date(s[0].getStartDate().getFullYear(),s[0].getStartDate().getMonth(),s[0].getStartDate().getDate())),T=t.getTime()===c.getTime(),b=S.length,v=this.getVisibleAppointmentsCount(),N,d,e;if(T){for(var i=0;i<b;i++){if(S[i].appointment.getEndDate().getTime()>n.getTime()){N=i;break;}}if(N===undefined){d=0;e=0;this._getMoreButton().setVisible(false);}else if((N+v)>b){if(N<=v&&(b-v<=0)){d=0;}else{d=b-v;}e=b;this._getMoreButton().setVisible(false);}else if((b-N)<=v){d=b-v;e=b;this._getMoreButton().setVisible(false);}else{d=N;e=N+v;this._getMoreButton().setVisible(true);}}else{d=0;if(b<=v){e=b;this._getMoreButton().setVisible(false);}else{e=v;this._getMoreButton().setVisible(true);}}return{iStart:d,iEnd:e};};a.prototype._getMoreButton=function(){if(!this._oMoreAppsButton){this._oMoreAppsButton=new B({text:"More"});}return this._oMoreAppsButton;};return a;});
