/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/integration/designtime/baseEditor/util/isValidBindingString","sap/ui/core/format/DateFormat"],function(B,i,D){"use strict";var a=B.extend("sap.ui.integration.designtime.baseEditor.propertyEditor.dateEditor.DateEditor",{xmlFragment:"sap.ui.integration.designtime.baseEditor.propertyEditor.dateEditor.DateEditor",renderer:B.getMetadata().getRenderer().render});a.prototype.formatValue=function(v){if(!v||i(v,false)){return v;}return this._formatDate(v);};a.prototype.asyncInit=function(){var d=this.getContent();d.onkeypress=function(e){if(!e.charCode||e.metaKey||e.ctrlKey){return;}};return Promise.resolve();};a.prototype._onChange=function(e){var v=e.getParameter("newValue");var p=this._parse(v);if(this._validate(v,p)){this._setInputState(true);this.setValue(p);}else{this._setInputState(false,this.getI18nProperty("BASE_EDITOR.DATE.INVALID_BINDING_OR_DATE"));}};a.prototype._parse=function(v){if(i(v,false)){return v;}var p=new Date(v);return this._isValidDate(p)?p.toISOString():undefined;};a.prototype._isValidDate=function(d){return d&&!isNaN(d.getTime());};a.prototype.getFormatterInstance=function(){return D.getDateInstance();};a.prototype._formatDate=function(d){var o=new Date(d);if(!this._isValidDate(o)){this._setInputState(false,this.getI18nProperty("BASE_EDITOR.DATE.INVALID_BINDING_OR_DATE"));return d;}this._setInputState(true);return this.getFormatterInstance().format(o);};a.prototype._validate=function(v,p){return typeof v==="undefined"||typeof p!=="undefined";};a.prototype._setInputState=function(I,e){var o=this.getContent();if(I){o.setValueState("None");}else{o.setValueState("Error");o.setValueStateText(e||"Unknown Error");}};return a;});
