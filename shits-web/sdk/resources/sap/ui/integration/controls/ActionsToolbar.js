/*!
* OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Core",'sap/ui/core/Control',"sap/m/library","sap/m/Button","sap/m/ActionSheet","sap/ui/integration/util/CardActions","./ActionsToolbarRenderer"],function(q,C,a,l,B,A,b){"use strict";var c=l.ButtonType;function s(o,p,v,e){return new Promise(function(r){var R;if(q.isFunction(v)){R=v(e);if(R instanceof Promise){R.then(function(f){o.setProperty(p,f);r();});return;}}else{R=v;}o.setProperty(p,R);r();});}var d=a.extend("sap.ui.integration.controls.ActionsToolbar",{metadata:{library:"sap.ui.integration",properties:{},aggregations:{_toolbar:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}}}});d.prototype._open=function(){this._refreshButtons().then(function(){this._oActionSheet.openBy(this._getToolbar());}.bind(this));};d.prototype._createActionButton=function(h,o,m){return new B({icon:m.icon,text:m.text,tooltip:m.tooltip,type:m.buttonType,press:function(e){b.fireAction({card:o,host:h,action:m,parameters:m.parameters,source:e.getSource(),url:m.url});}});};d.prototype._getToolbar=function(){var t=this.getAggregation('_toolbar');if(!t){t=new B({icon:'sap-icon://overflow',type:c.Transparent,press:function(e){this._open();}.bind(this)});this.setAggregation('_toolbar',t);}return t;};d.prototype.initializeContent=function(h,o){var t=this,e,f=[],g;this._oCard=o;this._aActions=g=h.getActions();if(!g||!g.length){return false;}g.forEach(function(i){e=t._createActionButton(h,o,i);f.push(e);});if(this._oActionSheet){this._oActionSheet.destroy();}this._oActionSheet=new A({buttons:f});return true;};d.prototype._refreshButtons=function(){var e=this._aActions,o=this._oCard,f=this._oActionSheet.getButtons(),m,g,i,p=[];for(i=0;i<e.length;i++){m=e[i];g=f[i];p.push(s(g,'enabled',m.enabled,o));p.push(s(g,'visible',m.visible,o));}return Promise.all(p);};d.prototype.exit=function(){this._oCard=null;this._aActions=null;if(this._oActionSheet){this._oActionSheet.destroy();this._oActionSheet=null;}};return d;});
