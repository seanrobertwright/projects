/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/layout/cssgrid/GridLayoutBase","sap/ui/layout/cssgrid/GridSettings","sap/ui/layout/cssgrid/VirtualGrid","sap/ui/Device","sap/ui/layout/library"],function(C,G,a,V,D){"use strict";var s=16;var p=8;var r=C.getConfiguration().getRTL();var S={"Phone":"sapUiLayoutCSSResponsiveColumnLayoutS","Tablet":"sapUiLayoutCSSResponsiveColumnLayoutM","Desktop":"sapUiLayoutCSSResponsiveColumnLayoutL","LargeDesktop":"sapUiLayoutCSSResponsiveColumnLayoutXL"};var m={"Phone":4,"Tablet":8,"Desktop":12,"LargeDesktop":16};function g(i){var l=i.getLayoutData();return(l&&l.isA("sap.ui.layout.cssgrid.ResponsiveColumnItemLayoutData"))?l.getColumns():1;}function b(i){var l=i.getLayoutData();return(l&&l.isA("sap.ui.layout.cssgrid.ResponsiveColumnItemLayoutData"))?l.getRows():1;}var R=G.extend("sap.ui.layout.cssgrid.ResponsiveColumnLayout",{metadata:{library:"sap.ui.layout",properties:{},events:{layoutChange:{parameters:{layout:{type:"string"}}}}}});R.prototype._sCurrentLayoutClassName="";R.prototype.isResponsive=function(){return true;};R.prototype.onGridAfterRendering=function(o){this._applyLayout(o,false);};R.prototype.getActiveGridSettings=function(){return null;};R.prototype.onGridResize=function(e){if(!e||e.size.width===0){return;}this._applyLayout(e.control,true);};R.prototype.renderSingleGridLayout=function(c){if(this.isGridSupportedByBrowser()){c.addClass("sapUiLayoutCSSResponsiveColumnLayoutGrid");}else{c.addClass("sapUiLayoutCSSResponsiveColumnLayoutGridPolyfill");}};R.prototype._applyLayout=function(o,t){var $=o.$().parent(),w=$.outerWidth(),c=D.media.getCurrentRange("StdExt",w),d=S[c.name],e=this.isGridSupportedByBrowser();if(!e){this._scheduleIEPolyfill(o,c);}if(this._sCurrentLayoutClassName===d){return;}if(e){o.removeStyleClass(this._sCurrentLayoutClassName);o.addStyleClass(d);}this._sCurrentLayoutClassName=d;if(t){this.fireLayoutChange({layout:c.name});}};R.prototype._scheduleIEPolyfill=function(o,c){if(this._iPolyfillCallId){clearTimeout(this._iPolyfillCallId);}this._iPolyfillCallId=setTimeout(function(){var d=o.isA("sap.f.GridList")?"listUl":"",$=o.$(d);this._applyIEPolyfillLayout(o,$,c);}.bind(this),0);};R.prototype._applyIEPolyfillLayout=function(o,$,c){if(o.bIsDestroyed){return;}var d=m[c.name],I=$.innerWidth(),e=o.getItems(),f=c.name==="Phone"?p:s,h=Math.floor((I-f*(d-1))/d),j,k,l,n,v,q,i;for(i=0;i<e.length;i++){l=e[i];n=l.$();j=g(l);n.css({position:'absolute',height:'auto',width:h*j+f*(j-1)});}var t=new V();t.init({numberOfCols:d,cellWidth:h,unitOfMeasure:"px",gapSize:f,topOffset:0,leftOffset:0,allowDenseFill:false,rtl:r,width:I,rowsAutoHeight:true});for(i=0;i<e.length;i++){l=e[i];if(!l.getVisible()){continue;}n=l.$();j=g(l);k=b(l);t.fitElement(i+'',j,k,n.outerHeight(true));}t.calculatePositions();v=t.getItems();for(i=0;i<e.length;i++){l=e[i];n=l.$();q=v[i];n.css({position:'absolute',top:q.top,left:q.left,height:q.height});}$.height(t.getHeight());};return R;});
