/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils","sap/m/MessageBox","sap/base/util/ObjectPath","sap/ui/rta/util/validateStableIds","sap/ui/rta/util/showMessageBox","sap/base/Log","sap/ui/rta/Utils","sap/ui/dt/Util"],function(F,M,O,v,s,L,U,D){"use strict";return function(r){function _(r,C,t,i,T){var j=C.getId();if(!m[j]){s(r._getTextResources().getText(t),{icon:M.Icon[i],title:r._getTextResources().getText(T),styleClass:U.getRtaStyleClassName()});a(j,true);}}function a(i,V){m[i]=V;}function b(C){var o=C.getManifest();return(O.get(["sap.app","id"],o)!=="sap.ui.documentation.sdk"&&!(O.get(["sap.app","id"],o)||"").startsWith("sap.ui.rta")&&!O.get(["sap.ovp"],o));}function c(){return("QUnit"in window||(window.frameElement&&(window.frameElement.getAttribute("id")||"").toLowerCase()==="opaframe"));}function d(i){return i&&!i._bIsBeingDestroyed;}function e(E){var n=E.getParameters().mode;if(n==="adaptation"){var r=E.getSource();var C=F.getAppComponentForControl(r.getRootControlInstance());p=p.filter(d);g(r,C,p);p=[];}}function f(E,r){var i=E.getParameters().elementOverlay;if(r.getMode()==="adaptation"){var C=F.getAppComponentForControl(r.getRootControlInstance());D.waitForSynced(r._oDesignTime,function(j){if(d(j)){g(r,C,[j]);}})(i);}else{p.push(i);}}function g(r,C,E){var u=v(E,C);if(u.length){u.forEach(function(i){L.error("Control ID was generated dynamically by SAPUI5. To support SAPUI5 flexibility, a stable control ID is needed to assign the changes to.",i.getElement().getId());});_(r,C,"MSG_UNSTABLE_ID_FOUND","ERROR","HEADER_ERROR");}}var m={};var p=[];var C=F.getAppComponentForControl(r.getRootControlInstance());r.attachEventOnce("stop",function(){a(C.getId(),false);});if(C&&b(C)){var o=C.getManifest();var h=O.get(["sap.ui5","flexEnabled"],o);if(typeof h!=="boolean"){if(!c()){_(r,C,"MSG_NO_FLEX_ENABLED_FLAG","WARNING","HEADER_WARNING");}}else{r.attachEvent("modeChanged",e);r._oDesignTime.attachEvent("elementOverlayCreated",r,f);g(r,C,r._oDesignTime.getElementOverlays());}}};});
