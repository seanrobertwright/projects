/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/Plugin","sap/ui/fl/Utils","sap/ui/rta/Utils"],function(P,F,R){"use strict";var B=P.extend("sap.ui.rta.plugin.BaseCreate",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});B.prototype._isEditable=function(o){return Promise.all([this._isEditableCheck(o,true),this._isEditableCheck(o,false)]).then(function(p){return{asSibling:p[0],asChild:p[1]};});};B.prototype._isEditableCheck=function(o,O){var p=this._getParentOverlay(O,o);var a;if(!p||!p.getParentElementOverlay()){return Promise.resolve(false);}if(O){a=o.getParentAggregationOverlay().getAggregationName();}return this.checkAggregationsOnSelf(p,this.getActionName(),a).then(function(e){if(e){var b=F.getViewForControl(p.getElement());return this.hasStableId(o)&&F.checkControlId(b);}return false;}.bind(this));};B.prototype._getParentOverlay=function(s,o){var p;if(s){p=o.getParentElementOverlay();}else{p=o;}return p;};B.prototype.getCreateActions=function(s,o){var p=this._getParentOverlay(s,o);var d=p.getDesignTimeMetadata();var a=d.getActionDataFromAggregations(this.getActionName(),o.getElement());if(s){var b=o.getParentAggregationOverlay().getAggregationName();return a.filter(function(A){return A.aggregation===b;});}return a;};B.prototype.getCreateAction=function(s,o){return this.getCreateActions(s,o)[0];};B.prototype.isAvailable=function(s,e){return this._isEditableByPlugin(e[0],s);};B.prototype.isEnabled=function(I,e){var E=e[0];var s;var a;if(typeof I==="boolean"){s=I;a=this.getCreateAction(s,E);}else{s=I.isSibling;a=I.action;}if(!a){return false;}if(a.isEnabled&&typeof a.isEnabled==="function"){var f=a.isEnabled;var p=this._getParentOverlay(s,E);return f(p.getElement());}return true;};B.prototype.getCreatedContainerId=function(a,n){var I=n;if(a.getCreatedContainerId&&typeof a.getCreatedContainerId==="function"){var m=a.getCreatedContainerId;I=m(n);}return I;};B.prototype._determineIndex=function(p,s,a,g){return R.getIndex(p,s,a,g);};B.prototype._getText=function(a,e,d,t){if(!a){return t;}var A=d.getAggregationDescription(a.aggregation,e);if(!A){return t;}var c=A.singular;var T=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");return T.getText(t,c);};B.prototype.getCreateMenuItemText=function(m,t,o){var a=m.action;var p=this._getParentOverlay(m.isSibling,o);var d=p.getDesignTimeMetadata();var e=p.getElement();return this._getText(a,e,d,t);};B.prototype.handler=function(h,e){this.handleCreate(h,e[0]);};B.prototype.getActionName=function(){throw new Error("abstract");};function i(){}B.prototype.getMenuItems=function(e){i(e);throw new Error("abstract");};B.prototype.handleCreate=function(s,o){i(s,o);throw new Error("abstract");};return B;});
