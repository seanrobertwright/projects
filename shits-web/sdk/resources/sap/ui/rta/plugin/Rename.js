/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/Plugin","sap/ui/rta/plugin/RenameHandler","sap/base/Log"],function(P,R,L){"use strict";var a=P.extend("sap.ui.rta.plugin.Rename",{metadata:{library:"sap.ui.rta",properties:{oldValue:"string"},associations:{},events:{editable:{},nonEditable:{}}}});a.prototype.exit=function(){P.prototype.exit.apply(this,arguments);this.setBusy(false);R._exit.call(this);};a.prototype.setDesignTime=function(d){R._setDesignTime.call(this,d);};a.prototype.startEdit=function(o){var e=o.getElement();var d=o.getDesignTimeMetadata();var D=d.getAction("rename",e).domRef;R.startEdit.call(this,{overlay:o,domRef:D,pluginMethodName:"plugin.Rename.startEdit"});};a.prototype.stopEdit=function(r){R._stopEdit.call(this,r,"plugin.Rename.stopEdit");};a.prototype.handler=function(e){this.startEdit(e[0]);};a.prototype.isRenameAvailable=function(o){return this._isEditableByPlugin(o);};a.prototype.isRenameEnabled=function(o){return this.isEnabled(o);};a.prototype.isEnabled=function(e){if(e.length>1){return false;}var t=e[0];var r=this.getResponsibleElementOverlay(t);var i=true;if(!this.getAction(r)){i=false;}var T=this.getAction(t);if(i&&typeof T.isEnabled!=="undefined"){if(typeof T.isEnabled==="function"){i=T.isEnabled(t.getElement());}else{i=t.isEnabled;}}if(i){var d=t.getDesignTimeMetadata();if(!d.getAssociatedDomRef(t.getElement(),T.domRef)){i=false;}}return i;};a.prototype.registerElementOverlay=function(o){o.attachEvent("editableChange",R._manageClickEvent,this);P.prototype.registerElementOverlay.apply(this,arguments);};a.prototype._isEditable=function(o){var e=o.getElement();var r=this.getAction(o);if(r&&r.changeType){if(r.changeOnRelevantContainer){e=o.getRelevantContainer();}return this.hasChangeHandler(r.changeType,e).then(function(h){return h&&this._checkRelevantContainerStableID(r,o)&&this.hasStableId(o);}.bind(this));}return false;};a.prototype.deregisterElementOverlay=function(o){o.detachEvent("editableChange",R._manageClickEvent,this);o.detachBrowserEvent("click",R._onClick,this);this.removeFromPluginsList(o);};a.prototype._emitLabelChangeEvent=function(){var t=R._getCurrentEditableFieldText.call(this);if(this.getOldValue()!==t){this._$oEditableControlDomRef.text(t);return Promise.resolve(this._oEditedOverlay).then(function(e){var r=this.getResponsibleElementOverlay(e);var o=r.getElement();var d=r.getDesignTimeMetadata();var v=this.getVariantManagementReference(r);return this.getCommandFactory().getCommandFor(o,"rename",{renamedElement:o,newValue:t},d,v);}.bind(this)).then(function(r){this.fireElementModified({command:r});}.bind(this)).catch(function(e){L.error("Error during rename : ",e);});}return Promise.resolve();};a.prototype.getMenuItems=function(e){return this._getMenuItems(e,{pluginId:"CTX_RENAME",rank:10,icon:"sap-icon://edit"});};a.prototype.getActionName=function(){return"rename";};return a;});
