/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/UriParameters","sap/ui/thirdparty/hasher","sap/ui/fl/Layer"],function(U,h,L){"use strict";var l=[L.BASE,L.VENDOR,L.PARTNER,L.CUSTOMER_BASE,L.CUSTOMER,L.USER];var m={};l.forEach(function(s,i){m[s]=i;});var a={_mLayersIndex:m,_sTopLayer:l[l.length-1],FL_MAX_LAYER_PARAM:"sap-ui-fl-max-layer",FL_DRAFT_PARAM:"sap-ui-fl-version",isVendorLayer:function(){return this.getCurrentLayer(false)===L.VENDOR;},isCustomerDependentLayer:function(s){return([L.CUSTOMER,L.CUSTOMER_BASE].indexOf(s)>-1);},doesCurrentLayerRequirePackage:function(){var c=this.getCurrentLayer(false);return(c===L.VENDOR)||(c===L.PARTNER)||(c===L.CUSTOMER_BASE);},getMaxLayer:function(){var p=a.getMaxLayerTechnicalParameter(h.getHash());return p||a.getUrlParameter(this.FL_MAX_LAYER_PARAM)||a._sTopLayer;},getLayerIndex:function(s){return this._mLayersIndex[s];},isOverMaxLayer:function(s){return(this.getLayerIndex(s)>this.getLayerIndex(this.getMaxLayer()));},compareAgainstCurrentLayer:function(s,c){var C=c||a.getCurrentLayer(false);if((this.getLayerIndex(C)>this.getLayerIndex(s))||!s){return-1;}else if(this.getLayerIndex(C)===this.getLayerIndex(s)){return 0;}return 1;},isLayerFilteringRequired:function(){return!(this._sTopLayer===this.getMaxLayer());},getCurrentLayer:function(i){if(i){return L.USER;}var s=this.getUrlParameter("sap-ui-layer")||"";s=s.toUpperCase();return s||L.CUSTOMER;},filterChangeDefinitionsByMaxLayer:function(c){return c.filter(function(C){if(C.layer&&a.isOverMaxLayer(C.layer)){return false;}return true;});},getUrlParameter:function(p){return U.fromQuery(window.location.search).get(p);},getUshellContainer:function(){return sap.ushell&&sap.ushell.Container;},getMaxLayerTechnicalParameter:function(H){var u=this.getUshellContainer();if(u){var p=u.getService("URLParsing").parseShellHash(H)||{};if(p.params&&p.params.hasOwnProperty(this.FL_MAX_LAYER_PARAM)){return p.params[this.FL_MAX_LAYER_PARAM][0];}}}};return a;},true);
