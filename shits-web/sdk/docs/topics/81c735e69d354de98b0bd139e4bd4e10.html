<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>OData V2 Messages</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="OData V2 messages are either created automatically by sap.ui.model.odata.ODataMessageParser and processed by the sap.ui.model.odata.v2.ODataModel or can be created manually by the application."><meta name="description" content="OData V2 messages are either created automatically by sap.ui.model.odata.ODataMessageParser and processed by the sap.ui.model.odata.v2.ODataModel or can be created manually by the application."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"8956f0a223284d729900ebad4ca88356.html","previousTopicHref":"a90d93df5a024e8bb18826b699c9aaa7.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"></div><div class="page concept  - topic-topic concept-concept " id="loio81c735e69d354de98b0bd139e4bd4e10"><h1 class="title topictitle1" hidden>OData V2 Messages</h1><div class="body conbody"><p class="shortdesc" hidden>OData V2 messages are either created automatically by
<samp class="ph codeph">sap.ui.model.odata.ODataMessageParser</samp> and processed by the
<samp class="ph codeph">sap.ui.model.odata.v2.ODataModel</samp> or can be created manually by the
application.</p>
<div class="section"><section class="section" type="Target"><h2 class="section_title" style="font-size: 1.15em;">Target</h2>

<p class="p">The target of these messages can be empty. In this case, the message has no specific target
and is relevant for the whole application. If a target is set, it must correspond to
a binding path which is then used to propagate the message to the corresponding
bindings. If these bindings belong to a control that implements the
<samp class="ph codeph">refreshDataState</samp> function, the control is able to react to data
state changes.</p>
</section></div>
<div class="section"><section class="section" type="Lifecycle"><h2 class="section_title" style="font-size: 1.15em;">Lifecycle</h2>

<p class="p">OData V2 messages are kept until a message from the server for the same path arrives.
The server always sends all messages for a specific target which means that all
current messages are replaced with the ones sent by the server, except for
<samp class="ph codeph">persistent</samp> UI messages. Back-end messages with property
<samp class="ph codeph">transition</samp> set to <samp class="ph codeph">true</samp> are parsed to
<samp class="ph codeph">persistent</samp> UI messages.</p>
</section></div>
<div class="section" id="loio81c735e69d354de98b0bd139e4bd4e10__section_vn1_jbj_rhb"><section class="section" type="Manually Created Messages"><h2 class="section_title" style="font-size: 1.15em;">Manually Created Messages</h2>

<p class="p">To create messages manually that are handled like OData messages, use
<samp class="ph codeph">model</samp> as message processor as follows:</p>
<pre class="pre codeblock prettyprint lang-js">// oMyModel is defined elsewhere...
// &quot;Input&quot; required from module &quot;sap/m/Input&quot;
// &quot;TypeFloat&quot; required from module &quot;sap/ui/model/type/Float&quot;
// &quot;Message&quot; required from module &quot;sap/ui/core/message/Message&quot;
// &quot;coreLibrary&quot; required from module &quot;sap/ui/core/library&quot;

var oMessageManager = sap.ui.getCore().getMessageManager();

oMessageManager.registerMessageProcessor(oMyModel);

var oInput = new Input({
    id: &quot;myInputId&quot;,
    value: { path: &quot;/Products(1)/Price&quot;, type: new TypeFloat() }
});

oMessageManager.addMessages(
    new Message({
        message: &quot;Price must contain only numbers&quot;,
        type: coreLibrary.MessageType.Error,
        target: &quot;/Products(1)/Price&quot;,
        processor: oMyModel
    })
);</pre>
</section></div>
<div class="section" id="loio81c735e69d354de98b0bd139e4bd4e10__section_ypv_nbj_rhb"><section class="section" type="Automatically Created Messages"><h2 class="section_title" style="font-size: 1.15em;">Automatically Created Messages</h2>

<p class="p">The <samp class="ph codeph">sap.ui.model.odata.v2.ODataModel</samp> supports automatic parsing of
OData V2 messages by means of
<samp class="ph codeph">sap.ui.model.odata.ODataMessageParser</samp>.</p>
<p class="p">For other back-end service types, an application can implement its own parser, see
<a class="xref" href="../../#/topic/2e532e6288854e5897a819a2ab6cc910.html" title="A message parser is a simple interface that is implemented to allow the propagation of messages from back end services. For messages from OData V2 services, the sap.ui.model.odata.ODataMessageParser is used." target="_top">Implementing Your Own OData V2 Message Parser</a>.</p>
</section></div>
<div class="section" id="loio81c735e69d354de98b0bd139e4bd4e10__section_ydt_pbj_rhb"><section class="section" type="OData V2 Message Parser"><h2 class="section_title" style="font-size: 1.15em;">OData V2 Message Parser</h2>

<p class="p">The <samp class="ph codeph">ODataMessageParser</samp> is created automatically for all <samp class="ph codeph">v2.ODataModel</samp> instances and parses all responses from
the server. The <samp class="ph codeph">ODataModel</samp> implements the message processor interface and is used to propagate the messages to the
message manager. In case of an error response, the response body is parsed for error messages. In case of a successful response, the
&quot;sap-message&quot; header is parsed as a JSON-formatted error object. The name of the header field can be changed by calling the
<samp class="ph codeph">setHeaderField()</samp> method on the <samp class="ph codeph">ODataMessageParser</samp>.</p>
</section></div>
<div class="section" id="loio81c735e69d354de98b0bd139e4bd4e10__section_mzk_rbj_rhb"><section class="section" type="Troubleshooting for the OData V2 Message Parser"><h2 class="section_title" style="font-size: 1.15em;">Troubleshooting for the OData V2 Message Parser</h2><p class="p">In this section you find known limitations of the
<samp class="ph codeph">ODataMessageParser</samp> and how you can resolve issues with
unexpected numbers of UI messages.</p><div class="sectiondiv subsection">
<p class="p subsectiontitle">Duplicate messages with different targets</p>
<p class="p">Mulitple OData changes that are part of the same change set are send as batch
request to the back end, for example:</p>
<ul class="ul" id="loio81c735e69d354de98b0bd139e4bd4e10__ul_k4n_ydj_rhb">
<li class="li">
<p class="p">Change operation (POST Product(&apos;id=123&apos;))</p>
</li>
<li class="li">
<p class="p">Change operation (POST Product(&apos;id=456&apos;))</p>
</li>
</ul>
<p class="p">If one change operation fails, the back end rolls back all operations of the
change set, but returns only a single message, for example:</p>
<pre class="pre codeblock prettyprint lang-js">{
  &quot;code&quot;: &quot;MYCODE/111&quot;,
  &quot;message&quot;: &quot;Invalid input!&quot;,
  &quot;severity&quot;: &quot;error&quot;,
  &quot;target&quot;: &quot;&quot;
}</pre>
<p class="p">This leads to two UI message objects with the following message targets:</p>
<ul class="ul" id="loio81c735e69d354de98b0bd139e4bd4e10__ul_slk_b2j_rhb">
<li class="li">
<p class="p">&quot;/Product(&apos;id=123&apos;)&quot;</p>
</li>
<li class="li">
<p class="p">&quot;/Product(&apos;id=456&apos;)&quot;</p>
</li>
</ul>
<p class="p"><span class="ph emphasis emphasis">Solution</span>: The message target has to be defined in the
back-end error message. By this, only one UI message which represents the failed
change is created and pushed into the central message model. Otherwise, the
<samp class="ph codeph">ODataMessageParser</samp> creates a separate error message for
every change included in the change set.</p>
</div><div class="sectiondiv subsection">
<p class="p subsectiontitle">Duplicate messages with the same target</p>
<p class="p">The OData service error response can also contain multiple inner-errors to
deliever more than one error message to the front end. The inner-error messages
should generally be used to describe the problem in more detail, for example</p>
<pre class="pre codeblock prettyprint lang-js">{
  &quot;code&quot;: &quot;MYCODE/111&quot;,
  &quot;message&quot;: &quot;Failed operations!&quot;,
  &quot;severity&quot;: &quot;error&quot;,
    &quot;details&quot;: [
    {
      &quot;code&quot;: &quot;MYCODE/222&quot;,
      &quot;message&quot;: &quot;Object 1 already exists!&quot;
      &quot;severity&quot;: &quot;error&quot;
    },
    {
      &quot;code&quot;: &quot;MYCODE/222&quot;,
      &quot;message&quot;: &quot;Object 2 already exists!&quot;
      &quot;severity&quot;: &quot;error&quot;
    },
    ...
  ]
}</pre>
<p class="p"><span class="ph emphasis emphasis">Solution</span>: The outer-error will also be parsed into a
separate UI error message. These general error messages, such as
<span class="ph uicontrol">Failed operations</span>, can be confusing for end users. To
prevent these general UI messages, the outer-error message has to have the same
error code and error message text (&quot;message&quot; property) as an inner-error. This
way, the outer message information is ignored, that is, not parsed into a UI
message, since there already is an inner-error message with more details that
represents the same issue.</p>
<p class="p"><span class="ph emphasis emphasis">Hint</span>: The duplicate detection only works for request body
error messages. For request header error messages, the unwanted outer-error must
be filtered out in the front end. As an alternative, the outer-error could
already represent the first detailed error, see the example error with message
<span class="ph uicontrol">Object 1 already exists</span>.</p>
</div><div class="sectiondiv subsection">
<p class="p subsectiontitle">Scenario 3: Missing UI messages</p>
<p class="p">This can happen when an OData entity is changed and the same entity is requested
again shortly afterwards. The change and the read operation could also be part
of the same batch request, for example:</p>
<ul class="ul" id="loio81c735e69d354de98b0bd139e4bd4e10__ul_ptz_skj_rhb">
<li class="li">
<p class="p">Change operation (&apos;POST&apos; request with target &quot;Product(&apos;id=123&apos;)&quot;)</p>
</li>
<li class="li">
<p class="p">Read operation (&apos;GET&apos; request with target &quot;Products&quot;)</p>
</li>
</ul>
<p class="p">If the change operation fails, a UI message is created. But this UI message is
deleted directly afterwards via the messaging lifecycle since the read operation
of the same entity does not return any message. There are two options to get the
expected behavior in this scenario:</p>
<p class="p"><span class="ph emphasis emphasis">Solution 1</span>: Mark the UI message as persistent. By this, the
message lifecycle will not delete the UI message, but the application has to
take care of cleaning up such messages by using the
<samp class="ph codeph">sap.ui.core.message.MessageManager</samp> APIs.</p>
<p class="p"><span class="ph emphasis emphasis">Solution 2</span>: Defer the read operation. By this, the UI
message is also not deleted, but the application has to make sure the read
operation is triggered at an appropriate point in time.</p>
<p class="p"><span class="ph emphasis emphasis">Hint</span>: The read operation is often automatically triggered by
the <samp class="ph codeph">v2.ODataModel</samp>. To prevent this request from being sent, you
can use the model parameter <samp class="ph codeph">refreshAfterChange</samp>.</p>
</div></section></div>
</div><div class="related-links"> <div class="relinfo"><div class="relinfotitle ">Related Information</div><div><a class="link" href="../../#/api/sap.ui.model.odata.v2.ODataModel" target="_top" alt="#/api/sap.ui.model.odata.v2.ODataModel" title="#/api/sap.ui.model.odata.v2.ODataModel">API Reference: <samp class="ph codeph">sap.ui.model.odata.v2.ODataModel</samp></a></div><div><a class="link" href="../../#/api/sap.ui.core.message.MessageManager" target="_top" alt="#/api/sap.ui.core.message.MessageManager" title="#/api/sap.ui.core.message.MessageManager">API Reference: <samp class="ph codeph">sap.ui.core.message.MessageManager</samp></a></div><div><a class="link" href="../../#/api/sap.ui.model.message.MessageModel" target="_top" alt="#/api/sap.ui.model.message.MessageModel" title="#/api/sap.ui.model.message.MessageModel">API Reference: <samp class="ph codeph">sap.ui.model.message.MessageModel</samp></a></div><div><a class="link" href="../../#/api/sap.ui.model.odata.ODataMessageParser" target="_top" alt="#/api/sap.ui.model.odata.ODataMessageParser" title="#/api/sap.ui.model.odata.ODataMessageParser">API Reference: <samp class="ph codeph">sap.ui.mode.odata.ODataMessageParser</samp></a></div><div><a class="link" href="../../#/topic/fbe1cb5613cf4a40a841750bf813238e.html" title="The OData V4 model supports server messages sent via an OData V4 service." target="_top">Server Messages in OData V4 Model</a></div></div></div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>