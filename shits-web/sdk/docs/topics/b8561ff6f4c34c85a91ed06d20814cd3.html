<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Step 9: Allow Bookmarkable Tabs with Optional Query Parameters</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="The resume view contains four tabs as we have seen in the previous steps. However, when the user navigates to the resume page, only the first tab is displayed initially. Navigating directly to a specific tab or bookmarking a tab is not yet supported in our current app."><meta name="description" content="The resume view contains four tabs as we have seen in the previous steps. However, when the user navigates to the resume page, only the first tab is displayed initially. Navigating directly to a specific tab or bookmarking a tab is not yet supported in our current app."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"cdab0a1123514cc08cf2c8deb22f312e.html","previousTopicHref":"3e5f6f3e163f46ecaef376950258e5e4.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"><div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/1b6dcd39a6a74f528b27ddb22f15af0d.html" title="OpenUI5 comes with a powerful routing API that helps you control the state of your application efficiently. This tutorial will illustrate all major features and APIs related to navigation and routing in OpenUI5 apps by creating a simple and easy to understand mobile app. It represents a set of best practices for applying the navigation and routing features of OpenUI5 to your applications." target="_top">Navigation and Routing</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/3e5f6f3e163f46ecaef376950258e5e4.html" title="In this step, we want to illustrate how to navigate to a page with a custom transition animation. Both forward and backward navigation will use the &#x201C;flip&#x201D; transition but with a different direction. We will create a simple link on the Employee view that triggers a flip navigation to a page that displays the resume data of a certain employee. Pressing the Back button will navigate back to the Employee view with a reversed flip transition." target="_top">Step 8: Navigate with Flip Transition</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/cdab0a1123514cc08cf2c8deb22f312e.html" title="In the previous steps, we have implemented a Resume view that uses tabs to display data. The complete content of the tabs is loaded once, no matter which tab is currently displayed. We can increase the performance of our app by avoiding to load content that is not visible. Therefore, we implement a &#x201C;lazy loading&#x201D; feature that only loads the view and data when requested by the user." target="_top">Step 10: Implement Lazy Loading</a><br></div></div></div><div class="page concept  - topic-topic concept-concept " id="loiob8561ff6f4c34c85a91ed06d20814cd3"><h1 class="title topictitle1" hidden>Step 9: Allow Bookmarkable Tabs with Optional Query Parameters</h1><div class="body conbody"><p class="shortdesc" hidden>The <samp class="ph codeph">resume</samp> view contains four tabs as we have seen in the previous steps. However, when the user navigates to the
<samp class="ph codeph">resume</samp> page, only the first tab is displayed initially. Navigating directly to a specific tab or bookmarking a tab is not yet
supported in our current app.</p>
<p class="p"> In this step, we implement a bookmarking feature by enabling deep linking to tabs with optional query parameters. A deep link is basically a link
that directly references a deeper structure and parameters of the app in the URL. It is often bookmarked or shared to have a convenient entry point
into the app for a certain task or action. The selected tab should be reflected in the URL but the tab can also be omitted, for example, when we
initially navigate to the resume page. </p>
<div class="section"><section class="section" type="Preview"><h2 class="section_title" style="font-size: 1.15em;">Preview</h2>

<div class="fig fignone" id="loiob8561ff6f4c34c85a91ed06d20814cd3__fig_r1j_pst_mr"><div class="figbody">

<img class="inline" id="loiob8561ff6f4c34c85a91ed06d20814cd3__image_gy5_3yn_ns" src="loio3eb33f8439b842629261fbd72a92d371_LowRes.png">
</div><span class="figcap">Deep link to allow bookmarkable tabs</span></div>
</section></div>
<div class="section"><section class="section" type="Coding"><h2 class="section_title" style="font-size: 1.15em;">Coding</h2>

<p class="p">You can view and download all files in the <span class="ph uicontrol">Samples</span> in the Demo Kit <span class="ph">at <a class="xref" href="../../#/sample/sap.ui.core.tutorial.navigation.09/preview" target="_top" alt="#/sample/sap.ui.core.tutorial.navigation.09/preview" title="#/sample/sap.ui.core.tutorial.navigation.09/preview">Routing and Navigation - Step 9</a></span>.</p>
</section></div>
<div class="section"><section class="section" type="webapp/manifest.json"><h2 class="section_title" style="font-size: 1.15em;">webapp/manifest.json</h2>

<pre class="pre codeblock prettyprint lang-js">{
	&quot;_version&quot;: &quot;1.12.0&quot;,
	&quot;sap.app&quot;: {
		...
	},
	&quot;sap.ui&quot;: {
		...
	},
	&quot;sap.ui5&quot;: {
		...
		&quot;routing&quot;: {
			&quot;config&quot;: {
				&quot;routerClass&quot;: &quot;sap.m.routing.Router&quot;,
				&quot;viewType&quot;: &quot;XML&quot;,
				&quot;viewPath&quot;: &quot;sap.ui.demo.nav.view&quot;,
				&quot;controlId&quot;: &quot;app&quot;,
				&quot;controlAggregation&quot;: &quot;pages&quot;,
				&quot;transition&quot;: &quot;slide&quot;,
				&quot;bypassed&quot;: {
					&quot;target&quot;: &quot;notFound&quot;
				}
			},
			&quot;routes&quot;: [{
				&quot;pattern&quot;: &quot;&quot;,
				&quot;name&quot;: &quot;appHome&quot;,
				&quot;target&quot;: &quot;home&quot;
			}, {
				&quot;pattern&quot;: &quot;employees&quot;,
				&quot;name&quot;: &quot;employeeList&quot;,
				&quot;target&quot;: &quot;employees&quot;
			}, {
				&quot;pattern&quot;: &quot;employees/{employeeId}&quot;,
				&quot;name&quot;: &quot;employee&quot;,
				&quot;target&quot;: &quot;employee&quot;
			}, {
				&quot;pattern&quot;: &quot;employees/{employeeId}/resume<span class="ph emphasis emphasis">:?query:</span>&quot;,
				&quot;name&quot;: &quot;employeeResume&quot;,
				&quot;target&quot;: &quot;employeeResume&quot;
			}],
			&quot;targets&quot;: {
				...
			}
		}
	}
}</pre>
<p class="p">Up until now, you could only navigate to an employee&#x2019;s resume with the deep link <samp class="ph codeph">webapp/index.html#/employees/3/resume</samp>. This
will always select the first tab as implemented by the <samp class="ph codeph">IconTabBar</samp> control. In order to open the page directly with a
specific tab selected and to make the tabs bookmarkable, we add the <samp class="ph codeph">?query</samp> parameter to the URL pattern.</p>
<p class="p">This allows URLs like <samp class="ph codeph">webapp/index.html#/employees/3/resume?tab=Projects</samp> where the query parameter defines which tab shall be
displayed. We change the pattern of the <samp class="ph codeph">employeeResume</samp> route to <samp class="ph codeph">employees/{employeeId}/resume:?query:</samp>. The new
part <samp class="ph codeph">:?query:</samp> allows to pass on queries with any parameters, for example, the hash
<samp class="ph codeph">/#/employees/3/resume?tab=Projects</samp> or <samp class="ph codeph">/#/employees/3/resume?tab=Projects&amp;action=edit</samp> matches the
pattern and can be processed in the matched event.</p>
<p class="p"> The <samp class="ph codeph">:?query:</samp> parameter starts and ends with &quot;<samp class="ph codeph">:</samp>&quot;, which means that it is optional. If you want to make it
mandatory, you can use the <samp class="ph codeph">{?query}</samp> syntax (everything in between <samp class="ph codeph">{}</samp> is considered as being
mandatory). </p>
</section></div>
<div class="section"><section class="section" type="webapp/view/employee/Resume.view.xml"><h2 class="section_title" style="font-size: 1.15em;">webapp/view/employee/Resume.view.xml</h2>

<pre class="pre codeblock prettyprint lang-xml">&lt;mvc:View
	controllerName=&quot;sap.ui.demo.nav.controller.employee.Resume&quot;
	xmlns=&quot;sap.m&quot;
	xmlns:mvc=&quot;sap.ui.core.mvc&quot;&gt;
	&lt;Page
		title=&quot;{i18n&gt;ResumeOf} {FirstName} {LastName}&quot;
		id=&quot;employeeResumePage&quot;
		showNavButton=&quot;true&quot;
		navButtonPress=&quot;.onNavBack&quot;&gt;
		&lt;content&gt;
			&lt;IconTabBar
				id=&quot;iconTabBar&quot;
				headerBackgroundDesign=&quot;Transparent&quot;
				class=&quot;sapUiResponsiveContentPadding&quot;
				binding=&quot;{Resume}&quot;
<span class="ph emphasis emphasis">				select=&quot;.onTabSelect&quot;
				selectedKey=&quot;{view&gt;/selectedTabKey}&quot;</span>&gt;
				&lt;items&gt;
					&lt;IconTabFilter id=&quot;infoTab&quot; text=&quot;{i18n&gt;tabInfo}&quot; key=&quot;Info&quot;&gt;
						&lt;Text text=&quot;{Information}&quot;/&gt;
					&lt;/IconTabFilter&gt;
					&lt;IconTabFilter id=&quot;projectsTab&quot; text=&quot;{i18n&gt;tabProjects}&quot; key=&quot;Projects&quot;&gt;
						&lt;mvc:XMLView viewName=&quot;sap.ui.demo.nav.view.employee.ResumeProjects&quot;&gt;&lt;/mvc:XMLView&gt;
					&lt;/IconTabFilter&gt;
					&lt;IconTabFilter id=&quot;hobbiesTab&quot; text=&quot;{i18n&gt;tabHobbies}&quot; key=&quot;Hobbies&quot;&gt;
						&lt;Text text=&quot;{Hobbies}&quot;/&gt;
					&lt;/IconTabFilter&gt;
					&lt;IconTabFilter id=&quot;notesTab&quot; text=&quot;{i18n&gt;tabNotes}&quot; key=&quot;Notes&quot;&gt;
						&lt;Text text=&quot;{Notes}&quot;/&gt;
					&lt;/IconTabFilter&gt;
				&lt;/items&gt;
			&lt;/IconTabBar&gt;
		&lt;/content&gt;
	&lt;/Page&gt;
&lt;/mvc:View&gt;
</pre>
<p class="p">To update the currently selected tab in the URL we listen to the select event of the <samp class="ph codeph">IconTabBar</samp> by setting
<samp class="ph codeph">select=&quot;.onTabSelect&quot;</samp> in the resume view. The <samp class="ph codeph">selectedKey</samp> is bound to a view model. This allows
to easily change the <samp class="ph codeph">selectedKey</samp> according to the selected tab in the URL.</p>
</section></div>
<div class="section"><section class="section" type="webapp/controller/employee/Resume.controller.js"><h2 class="section_title" style="font-size: 1.15em;">webapp/controller/employee/Resume.controller.js</h2>

<pre class="pre codeblock prettyprint lang-js">sap.ui.define([
	&quot;sap/ui/demo/nav/controller/BaseController&quot;<span class="ph emphasis emphasis">,
	&quot;sap/ui/model/json/JSONModel&quot;
</span>
], function (BaseController<span class="ph emphasis emphasis">, JSONModel</span>) {
	&quot;use strict&quot;;
	<span class="ph emphasis emphasis">var _aValidTabKeys = [&quot;Info&quot;, &quot;Projects&quot;, &quot;Hobbies&quot;, &quot;Notes&quot;];</span>
	return BaseController.extend(&quot;sap.ui.demo.nav.controller.employee.Resume&quot;, {
		onInit: function () {
			var oRouter = this.getRouter();
			<span class="ph emphasis emphasis">this.getView().setModel(new JSONModel(), &quot;view&quot;);
</span>
			oRouter.getRoute(&quot;employeeResume&quot;).attachMatched(this._onRouteMatched, this);
		},
		_onRouteMatched: function (oEvent) {
			var oArgs, oView<span class="ph emphasis emphasis">, oQuery</span>;
			oArgs = oEvent.getParameter(&quot;arguments&quot;);
			oView = this.getView();
			oView.bindElement({
				path: &quot;/Employees(&quot; + oArgs.employeeId + &quot;)&quot;,
				events: {
					change: this._onBindingChange.bind(this),
					dataRequested: function (oEvent) {
						oView.setBusy(true);
					},
					dataReceived: function (oEvent) {
						oView.setBusy(false);
					}
				}
			});<span class="ph emphasis emphasis">
			oQuery = oArgs[&quot;?query&quot;];
			if (oQuery &amp;&amp; _aValidTabKeys.indexOf(oQuery.tab) &gt; -1){
				oView.getModel(&quot;view&quot;).setProperty(&quot;/selectedTabKey&quot;, oQuery.tab);
			} else {
				// the default query param should be visible at all time
				this.getRouter().navTo(&quot;employeeResume&quot;, {
					employeeId: oArgs.employeeId,
					&quot;?query&quot;: {
						tab: _aValidTabKeys[0]
					}
				}, true /*no history*/);
			}
</span>
		},
		_onBindingChange: function (oEvent) {
			// No data for the binding
			if (!this.getView().getBindingContext()) {
				this.getRouter().getTargets().display(&quot;notFound&quot;);
			}
		}<span class="ph emphasis emphasis">,
		onTabSelect: function (oEvent){
			var oCtx = this.getView().getBindingContext();
			this.getRouter().navTo(&quot;employeeResume&quot;, {
				employeeId: oCtx.getProperty(&quot;EmployeeID&quot;),
				&quot;?query&quot;: {
					tab: oEvent.getParameter(&quot;selectedKey&quot;)
				}
			}, true /*without history*/);
		}
</span>
	});
});</pre>
<p class="p">When a tab is selected manually, its select handler is called. Therefore, let&#x2019;s first have a look at the <samp class="ph codeph">onTabSelect</samp> event
handler that is added at the end of the <samp class="ph codeph">resume</samp> controller. It detects the <samp class="ph codeph">selectedKey</samp> of the tab and navigates
to the <samp class="ph codeph">employeeResume</samp> route to update the URL in the address bar. Additionally to the mandatory parameter
<samp class="ph codeph">employeeId</samp>, we pass on a custom <samp class="ph codeph">query</samp> object with a parameter <samp class="ph codeph">tab</samp> and fill it with the
<samp class="ph codeph">selectedKey</samp> value that we receive from the <samp class="ph codeph">select</samp> event of the <samp class="ph codeph">IconTabBar</samp>. By passing on
<samp class="ph codeph">true</samp> as the third argument we replace the current history to make sure that manually clicked tabs won&#x2019;t be added to the
browser history.</p>
<p class="p">A dependency to <samp class="ph codeph">sap/ui/model/json/JSONModel</samp> is added to the controller. Now, we modify the <samp class="ph codeph">onInit</samp> function to
instantiate a JSONModel and use it as the <samp class="ph codeph">view</samp> model. <samp class="ph codeph">_aValidTabKeys</samp> is added to the controller. We want to
make sure that only valid tabs can be selected. Therefore, the <samp class="ph codeph">array _aValidTabKeys</samp> contains all allowed tab keys that we can
check against to validate the tab parameter from the URL later. The keys are equal to the keys of our <samp class="ph codeph">IconTabFilters</samp> in the
<samp class="ph codeph">resume</samp> view.</p>
<p class="p">In the <samp class="ph codeph">_onRouteMatched</samp> event handler, we add the <samp class="ph codeph">oQuery</samp> variable to store a reference to the query object from
the router. This allows a more comfortable access to the query object.</p>
<p class="p">In case a query object is passed on and the <samp class="ph codeph">tab</samp> parameter has a valid value, we display the specific tab by updating the
property <samp class="ph codeph">selectedTabKey</samp> in the view model. As the <samp class="ph codeph">selectedKey</samp> property of the
<samp class="ph codeph">IconTabBar</samp> is bound to <samp class="ph codeph">{view&gt;/selectedTabKey}</samp> the corresponding tab is selected.</p>
<p class="p">The <samp class="ph codeph">else</samp> case is called when either no or an invalid tab parameter is specified. We navigate to the <span class="ph uicontrol">Info</span>
tab to make sure that the tab parameter is reflected in the URL at all times. The actual requirements of your app might differ, feel free to
change it accordingly...</p>
</section></div>
<div class="section">
<div class="p">From now on our tabs are bookmarkable. Try to access the following (deep) links directly:<ul class="ul" id="loiob8561ff6f4c34c85a91ed06d20814cd3__ul_atc_g24_ns">
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/3/resume</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/3/resume?tab=Info</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/3/resume?tab=Projects</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/3/resume?tab=Hobbies</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/3/resume?tab=Notes</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/3/resume?tab=SomethingInvalid</samp></p>
</li>
</ul>When you click on any tab you will see that the hash in the URL changes immediately, and when you change the hash in the URL parameter
manually, you can see that the UI is also updated accordingly.</div>
</div>
</div><div class="related-links"> <div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/1b6dcd39a6a74f528b27ddb22f15af0d.html" title="OpenUI5 comes with a powerful routing API that helps you control the state of your application efficiently. This tutorial will illustrate all major features and APIs related to navigation and routing in OpenUI5 apps by creating a simple and easy to understand mobile app. It represents a set of best practices for applying the navigation and routing features of OpenUI5 to your applications." target="_top">Navigation and Routing</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/3e5f6f3e163f46ecaef376950258e5e4.html" title="In this step, we want to illustrate how to navigate to a page with a custom transition animation. Both forward and backward navigation will use the &#x201C;flip&#x201D; transition but with a different direction. We will create a simple link on the Employee view that triggers a flip navigation to a page that displays the resume data of a certain employee. Pressing the Back button will navigate back to the Employee view with a reversed flip transition." target="_top">Step 8: Navigate with Flip Transition</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/cdab0a1123514cc08cf2c8deb22f312e.html" title="In the previous steps, we have implemented a Resume view that uses tabs to display data. The complete content of the tabs is loaded once, no matter which tab is currently displayed. We can increase the performance of our app by avoiding to load content that is not visible. Therefore, we implement a &#x201C;lazy loading&#x201D; feature that only loads the view and data when requested by the user." target="_top">Step 10: Implement Lazy Loading</a><br></div></div><div class="relinfo"><div class="relinfotitle ">Related Information</div><div><a class="link" href="../../#/api/sap.m.IconTabBar" target="_top" alt="#/api/sap.m.IconTabBar" title="#/api/sap.m.IconTabBar">API Reference: <samp class="ph codeph">sap.m.IconTabBar</samp></a></div></div></div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>