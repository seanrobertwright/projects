<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cache Buster for OpenUI5</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="A cache buster allows OpenUI5 to notify the browser to refresh the resources only when the OpenUI5 resources have been changed. As long as they are not changed, the resources can always be fetched from the browser&apos;s cache."><meta name="description" content="A cache buster allows OpenUI5 to notify the browser to refresh the resources only when the OpenUI5 resources have been changed. As long as they are not changed, the resources can always be fetched from the browser&apos;s cache."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"ff7aceda0bd24039beb9bca8e882825d.html","previousTopicHref":"61ee9ed2369f4764a6d713abcf73afc1.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"></div><div class="page topic  - topic-topic " id="loio91f080966f4d1014b6dd926db0e91070"><h1 class="title topictitle1" hidden>Cache Buster for <span class="ph"><span class="ph pname">OpenUI5</span></span></h1><div class="body"><p class="shortdesc" hidden>A cache buster allows <span class="ph"><span class="ph pname">OpenUI5</span></span> to notify the browser to
refresh the resources only when the <span class="ph"><span class="ph pname">OpenUI5</span></span> resources have been
changed. As long as they are not changed, the resources can always be fetched from the
browser&apos;s cache.</p>
<aside class="note" aria-labelledby="note_0_title"><div class="title" id="note_0_title"><strong>Note</strong></div>
<p class="p"><span class="ph"><span class="ph pname">OpenUI5</span></span> supports the
cache buster concept for Java and ABAP servers and for <span class="ph pname">SAP Cloud Platform</span>. <span class="ph pname">SAP HANA</span> XS does
<span class="ph emphasis emphasis">not</span> support the cache buster concept.</p></aside>
<p class="p">When you want to cache your resources permanently, you simply need to change the URL in
the <span class="ph"><span class="ph pname">OpenUI5</span></span> bootstrap tag
from <samp class="ph codeph">resources/sap-ui-core.js</samp> to
<samp class="ph codeph">resources/sap-ui-cachebuster/sap-ui-core.js</samp>. </p>
<p class="p">The cache buster mechanism allows to always put the <span class="ph"><span class="ph pname">OpenUI5</span></span> resources into the
browsers cache until a UI library or a web application has been changed. The default
behavior of the <span class="ph"><span class="ph pname">OpenUI5</span></span>
resource handler is either to cache the resources for a specific amount of time or
alternatively in development mode it is using the <samp class="ph codeph">304/NOT MODIFIED</samp>
mechanism to check the <span class="ph"><span class="ph pname">OpenUI5</span></span> resources for being up-to-date. Both mechanisms are not optimal in a final,
productive scenario - that is the reason for the implementation of the cache buster
mechanism. Applications, which want to use the cache buster mechanism, have to
explicitly decide to use it. </p>
<p class="p">The cache buster mechanism is part of the resource servlet. In general, requests to
JavaScript resources can be handled via the cache buster mechanism. Typically this is
used for the initial request for the bootstrap JavaScript: </p>
<pre class="pre codeblock prettyprint lang-html">  &lt;script type=&quot;text/javascript&quot; 
  	id=&quot;sap-ui-bootstrap&quot;
  	src=&quot;resources/sap-ui-cachebuster/sap-ui-core.js&quot;
  	data-sap-ui-libs=&quot;sap.ui.core,sap.m,sap.ui.table&quot;
	data-sap-ui-theme=&quot;sap_belize&quot;&gt;&lt;/script&gt;</pre>
<p class="p">The bootstrap JavaScript will be included via the URL
<samp class="ph codeph">resources/sap-ui-cachebuster/sap-ui-core.js</samp> instead of
<samp class="ph codeph">resources/sap-ui-core.js</samp>. </p>
<div class="section" id="loio91f080966f4d1014b6dd926db0e91070__section_854964900D904B06AC93A9948B313E31"><section class="section" type="Mechanism"><h2 class="section_title" style="font-size: 1.15em;">Mechanism</h2>

<p class="p">The basic mechanism is implemented in the <samp class="ph codeph">ResourceServlet</samp>. For the
request to the bootstrap JavaScript it now serves a JavaScript file with the
following content: </p>
<pre class="pre codeblock prettyprint lang-js">(function() {
  var sTimeStamp = &apos;~20120716-0201~&apos;;
  var sScriptPath = &apos;sap\x2dui\x2dcore.js&apos;;
  var aScriptTags = document.getElementsByTagName(&apos;script&apos;);
  for (var i = 0; i &lt; aScriptTags.length; i++) {
    if (aScriptTags[i].src) {
      var iIdxCb = aScriptTags[i].src.indexOf(&apos;/sap-ui-cachebuster/&apos;);
      if (iIdxCb &gt;= 0 &amp;&amp; aScriptTags[i].src.substring(iIdxCb + &apos;/sap-ui-cachebuster/&apos;.length) == sScriptPath) {
        var sBasePath = aScriptTags[i].src.substring(0, iIdxCb);
        sBasePath += &apos;/&apos; + sTimeStamp + &apos;/&apos;;
        window[&quot;sap-ui-config&quot;] = window[&quot;sap-ui-config&quot;] || {};
        window[&quot;sap-ui-config&quot;].resourceRoots = window[&quot;sap-ui-config&quot;].resourceRoots || {};
        window[&quot;sap-ui-config&quot;].resourceRoots[&apos;&apos;] = sBasePath;
        document.write(&apos;&lt;script type=&quot;text/javascript&quot; src=&quot;&apos; + sBasePath + sScriptPath + &apos;&quot;&gt;&lt;/script&gt;&apos;)
        break;
      }
    }
  }
})();</pre>
<p class="p">This script basically ensures that the global <span class="ph"><span class="ph pname">OpenUI5</span></span> configuration
variable (<samp class="ph codeph">window[&quot;sap-ui-config&quot;]</samp>) exists, without modifying any
existing values. It defines the resource root of <span class="ph"><span class="ph pname">OpenUI5</span></span> (the location
where <span class="ph"><span class="ph pname">OpenUI5</span></span> loads all
JavaScript modules, controls and control related resources from). Finally, another
script tag is added to the page that points to the real boostrap JavaScript. The new
resource root and the request path to the bootstrap JavaScript now contain a
timestamp. Additionally the cache headers of the responses now look like the
following: </p>
<pre class="pre codeblock prettyprint">Date: Mon, 16 Jul 2012 05:17:54 GMT
Expires: Thu, 14 Jul 2022 05:17:54 GMT
Cache-Control: max-age=315360000, public</pre>
<p class="p">By default all cache buster resources will be cached for one year. </p>
</section></div>
<div class="section" id="loio91f080966f4d1014b6dd926db0e91070__section_CE7E0979C4904BAB8D627BDBF74DC262"><section class="section" type="Request Flow"><h2 class="section_title" style="font-size: 1.15em;">Request Flow</h2>

<p class="p">When using the cache buster mechanism, the first request must never be cached because
it is being used to determine the timestamp / and to finally redirect to the correct
script. The following list explains the flow: </p>
<ul class="ul">
<li class="li">
<p class="p"><samp class="ph codeph">resources/sap-ui-cachebuster/sap-ui-core.js</samp> =&gt; NO_CACHE
</p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">resources/~201106210204~/sap-ui-core.js</samp> =&gt;CACHE </p>
</li>
</ul>
</section></div>
<div class="section" id="loio91f080966f4d1014b6dd926db0e91070__section_EA1BCA523C48462CB21AC33F705872FA"><section class="section" type="Timestamp"><h2 class="section_title" style="font-size: 1.15em;">Timestamp</h2>

<p class="p">If you are interested in the timestamp of the cache buster, you can grab it with the
following request: </p>
<p class="p"><samp class="ph codeph">resources/sap-ui-cachebuster </samp>
</p>
<p class="p">The response is <samp class="ph codeph">text/plain</samp> with such value:
<samp class="ph codeph">~20120716-0201~</samp>
</p>
</section></div>
</div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>