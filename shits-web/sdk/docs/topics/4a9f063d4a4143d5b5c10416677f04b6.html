<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Step 9: Adding the Post Page</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="Now that we have covered all kinds of tests for navigation, we introduce our Post page that shows details of a post in the bulletin board. To achieve this, we have to introduce a new view/controller pair and adjust the routing of the application."><meta name="description" content="Now that we have covered all kinds of tests for navigation, we introduce our Post page that shows details of a post in the bulletin board. To achieve this, we have to introduce a new view/controller pair and adjust the routing of the application."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"07c97a2e497d443eb6fa74bb9445ab9c.html","previousTopicHref":"10592affce3e4f1ba73c3125ee06e0b7.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"><div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/291c9121e6044ab381e0b51716f97f52.html" title="In this tutorial we will test application functionality with the testing tools that are delivered with OpenUI5. At different steps of this tutorial you will write tests using QUnit, OPA5, and the mock server. Additionally, you will learn about testing strategies, Test Driven Development (TDD), and much more." target="_top">Testing</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/10592affce3e4f1ba73c3125ee06e0b7.html" title="So far, we have a list of posts on the home page of the app. But typically, a post comes with more details that should be displayed on a separate detail page. We call it the post page because it displays details of a post. In this step we will introduce a new journey to test the post page. We write tests that trigger typical navigation events with OPA. Testing navigation greatly helps in reducing manual testing efforts as it covers a lot of testing paths. It is good practice to cover every view of your application with at least one test, since OPA will check if an exception is thrown. In this way you can detect critical errors very fast." target="_top">Step 8: Testing Navigation</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/07c97a2e497d443eb6fa74bb9445ab9c.html" title="In this step, we will step back from our tests and application features that we have implemented so far and add another important piece of test code: The test suite page. A test suite can execute multiple tests and collect the results. This comes in handy for automatic tools in a continuous integration process." target="_top">Step 10: Test Suite and Automated Testing</a><br></div></div></div><div class="page concept  - topic-topic concept-concept " id="loio4a9f063d4a4143d5b5c10416677f04b6"><h1 class="title topictitle1" hidden>Step 9: Adding the <span class="ph uicontrol">Post</span> Page</h1><div class="body conbody"><p class="shortdesc" hidden>Now that we have covered all kinds of tests for navigation, we introduce our
<span class="ph uicontrol">Post</span> page that shows details of a post in the bulletin board. To
achieve this, we have to introduce a new view/controller pair and adjust the routing of the
application.</p>
<div class="section"><section class="section" type="Preview"><h2 class="section_title" style="font-size: 1.15em;">Preview</h2>

<div class="fig fignone" id="loio4a9f063d4a4143d5b5c10416677f04b6__fig_r1j_pst_mr"><div class="figbody">

<img class="inline" id="loio4a9f063d4a4143d5b5c10416677f04b6__image_j4j_bvv_3t" src="loio38c810b97e5b48bba08032aed403bb07_LowRes.png">
</div><span class="figcap">The <span class="ph uicontrol">Post</span> page with more details about the post</span></div>
</section></div>
<div class="section"><section class="section" type="Coding"><h2 class="section_title" style="font-size: 1.15em;">Coding</h2>

<p class="p">You can view and download all files in the <span class="ph uicontrol">Samples</span> in the Demo Kit
<span class="ph">at <a class="xref" href="../../#/sample/sap.m.tutorial.testing.09/preview" target="_top" alt="#/sample/sap.m.tutorial.testing.09/preview" title="#/sample/sap.m.tutorial.testing.09/preview">Testing - Step 9</a></span>.</p>
</section></div>
<div class="section"><section class="section" type="webapp/manifest.json"><h2 class="section_title" style="font-size: 1.15em;">webapp/manifest.json</h2>

<pre class="pre codeblock prettyprint lang-js">{
	&quot;_version&quot;: &quot;1.12.0&quot;,
	&#x2026;
	&quot;sap.ui5&quot;: {
	&#x2026;
		&quot;routing&quot;: {
			&quot;config&quot;: {
				&quot;routerClass&quot;: &quot;sap.m.routing.Router&quot;,
				&quot;viewType&quot;: &quot;XML&quot;,
				&quot;viewPath&quot;: &quot;sap.ui.demo.bulletinboard.view&quot;,
				&quot;controlId&quot;: &quot;app&quot;,
				&quot;controlAggregation&quot;: &quot;pages&quot;,
				&quot;async&quot;: true
			},
			&quot;routes&quot;: [
				{
					&quot;pattern&quot;: &quot;&quot;,
					&quot;name&quot;: &quot;worklist&quot;,
					&quot;target&quot;: &quot;worklist&quot;
				}<span class="ph emphasis emphasis">,
				{
					&quot;pattern&quot;: &quot;Post/{postId}&quot;,
					&quot;name&quot;: &quot;post&quot;,
					&quot;target&quot;: &quot;post&quot;
				}
</span>
			],
			&quot;targets&quot;: {
				&quot;worklist&quot;: {
					&quot;viewName&quot;: &quot;Worklist&quot;,
					&quot;viewId&quot;: &quot;worklist&quot;,
					&quot;viewLevel&quot;: 1
				}<span class="ph emphasis emphasis">,
				&quot;post&quot;: {
					&quot;viewName&quot;: &quot;Post&quot;,
					&quot;viewId&quot;: &quot;post&quot;,
					&quot;viewLevel&quot;: 2
				}
</span>
			}
		}
	}
}</pre>
<p class="p">We have already used the <samp class="ph codeph">#/Posts/{postId}</samp> hash in our tests and a view called
the <span class="ph uicontrol">Post</span> page, so we will now add a route and a target to
the routing configuration of the descriptor with these patterns. It is simply
defining a mandatory routing parameter <samp class="ph codeph">postId</samp> that we fill with the
ID from the model when navigating. The target configuration references a view called
<samp class="ph codeph">Post</samp> with a view level deeper than the home page. For more
information, see the <a class="xref" href="../../#/topic/1b6dcd39a6a74f528b27ddb22f15af0d.html" title="OpenUI5 comes with a powerful routing API that helps you control the state of your application efficiently. This tutorial will illustrate all major features and APIs related to navigation and routing in OpenUI5 apps by creating a simple and easy to understand mobile app. It represents a set of best practices for applying the navigation and routing features of OpenUI5 to your applications." target="_top">Navigation and Routing</a>
tutorial.</p>
</section></div>
<div class="section"><section class="section" type="webapp/view/Worklist.view.xml"><h2 class="section_title" style="font-size: 1.15em;">webapp/view/Worklist.view.xml</h2>

<pre class="pre codeblock prettyprint lang-xml">&lt;mvc:View
	controllerName=&quot;sap.ui.demo.bulletinboard.controller.Worklist&quot;
	xmlns=&quot;sap.m&quot;
	xmlns:mvc=&quot;sap.ui.core.mvc&quot;
	xmlns:core=&quot;sap.ui.core&quot;
	xmlns:semantic=&quot;sap.m.semantic&quot;&gt;
	&lt;semantic:FullscreenPage
		id=&quot;page&quot;
		title=&quot;{i18n&gt;worklistViewTitle}&quot;&gt;
		&lt;semantic:content&gt;
			&lt;Table &#x2026;&gt;
				&#x2026;
				&lt;items&gt;
					&lt;ColumnListItem
						<span class="ph emphasis emphasis">vAlign=&quot;Middle&quot;
						type=&quot;Navigation&quot;
						press=&quot;.onPress&quot;</span>&gt;
						&#x2026;
					&lt;/ColumnListItem&gt;
				&lt;/items&gt;
			&lt;/Table&gt;
		&lt;/semantic:content&gt;
		&#x2026;
	&lt;/semantic:FullscreenPage&gt;
&lt;/mvc:View&gt;</pre>
<p class="p">We configure the table items to be of type <samp class="ph codeph">Navigation</samp>, so a user can trigger
the navigation by choosing an item. When a <samp class="ph codeph">press</samp> event is
triggered, the <samp class="ph codeph">onPress</samp> handler is called to navigate to the
<span class="ph uicontrol">Post</span> page.</p>
</section></div>
<div class="section"><section class="section" type="webapp/controller/Worklist.controller.js"><h2 class="section_title" style="font-size: 1.15em;">webapp/controller/Worklist.controller.js</h2>

<pre class="pre codeblock prettyprint lang-js">sap.ui.define([
    &apos;./BaseController&apos;,
    &apos;sap/ui/model/json/JSONModel&apos;,
    &apos;../model/formatter&apos;,
    &apos;../model/FlaggedType&apos;,
    &apos;sap/m/library&apos;
], function(BaseController, JSONModel, formatter, FlaggedType, mobileLibrary) {
	&quot;use strict&quot;;

	return BaseController.extend(&quot;sap.ui.demo.bulletinboard.controller.Worklist&quot;, {
		&#x2026;
		/* =========================================================== */
		/* event handlers                                              */
		/* =========================================================== */
		&#x2026;
		<span class="ph emphasis emphasis">		/**
		 * Event handler when a table item gets pressed
		 * @param {sap.ui.base.Event} oEvent the table selectionChange event
		 * @public
		 */
		onPress: function (oEvent) {
			this.getRouter().navTo(&quot;post&quot;, {
				// The source is the list item that got pressed
				postId: oEvent.getSource().getBindingContext().getProperty(&quot;PostID&quot;)
			});

		},</span>
		&#x2026;
	});
});</pre>
<p class="p">The <samp class="ph codeph">press</samp> handler function instructs the <samp class="ph codeph">router</samp> to navigate
to the <samp class="ph codeph">post</samp> pattern with the <samp class="ph codeph">PostID</samp> from the
binding context of the currently selected item. This fills the mandatory URL
parameter, navigates to the <samp class="ph codeph">post</samp> page, and updates the hash
automatically.</p>
</section></div>
<div class="section"><section class="section" type="webapp/view/Post.view.xml (New)"><h2 class="section_title" style="font-size: 1.15em;">webapp/view/Post.view.xml (New)</h2>

<pre class="pre codeblock prettyprint lang-xml"><span class="ph emphasis emphasis">&lt;mvc:View
		controllerName=&quot;sap.ui.demo.bulletinboard.controller.Post&quot;
		xmlns=&quot;sap.m&quot;
		xmlns:mvc=&quot;sap.ui.core.mvc&quot;
		xmlns:semantic=&quot;sap.m.semantic&quot;&gt;
	&lt;semantic:FullscreenPage
			id=&quot;page&quot; 
			busy=&quot;{postView&gt;/busy}&quot;
			busyIndicatorDelay=&quot;0&quot;
			navButtonPress=&quot;.onNavBack&quot;
			showNavButton=&quot;true&quot;
			title=&quot;{i18n&gt;objectTitle}&quot;&gt;
		&lt;semantic:content&gt;
			&lt;ObjectHeader
					id=&quot;objectHeader&quot;
					title=&quot;{Title}&quot;
					number=&quot;{
						path: &apos;Price&apos;,
						formatter: &apos;.formatter.numberUnit&apos;
					}&quot;
					numberUnit=&quot;{Currency}&quot;
					backgroundDesign=&quot;Translucent&quot;&gt;
			&lt;/ObjectHeader&gt;
		&lt;/semantic:content&gt;
	&lt;/semantic:FullscreenPage&gt;
&lt;/mvc:View&gt;</span></pre>
<div class="p">We provide a minimalistic detail page showing only some fields of the selected post for now.
In the test we use the following information:<ul class="ul" id="loio4a9f063d4a4143d5b5c10416677f04b6__ul_jzj_nxb_jt">
<li class="li">
<p class="p">Control with the ID <samp class="ph codeph">page</samp> on this view</p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">title</samp> of the post we navigate to</p>
</li>
<li class="li">
<p class="p"><span class="ph uicontrol">Back</span> button to navigate back to the home page</p>
</li>
</ul></div>
</section></div>
<div class="section"><section class="section" type="webapp/controller/Post.controller.js (New)"><h2 class="section_title" style="font-size: 1.15em;">webapp/controller/Post.controller.js (New)</h2>

<pre class="pre codeblock prettyprint lang-js"><span class="ph emphasis emphasis">sap.ui.define([
	&apos;./BaseController&apos;,
	&apos;sap/ui/model/json/JSONModel&apos;,
	&apos;../model/formatter&apos;
], function (BaseController, JSONModel, formatter) {
	&quot;use strict&quot;;
	return BaseController.extend(&quot;sap.ui.demo.bulletinboard.controller.Post&quot;, {
		formatter: formatter,
		/* =========================================================== */
		/* lifecycle methods                                           */
		/* =========================================================== */
		/**
		 * Called when the worklist controller is instantiated.
		 * @public
		 */
		onInit: function () {
			// Model used to manipulate control states. The chosen values make sure,
			// detail page is busy indication immediately so there is no break in
			// between the busy indication for loading the view&apos;s meta data
			var oViewModel = new JSONModel({
					busy: false
				});
			this.getRouter().getRoute(&quot;post&quot;).attachPatternMatched(this._onPostMatched, this);
			this.setModel(oViewModel, &quot;postView&quot;);
		},
		/* =========================================================== */
		/* event handlers                                              */
		/* =========================================================== */
		/**
		 * Navigates back to the worklist
		 * @function
		 */
		onNavBack: function () {
			this.myNavBack(&quot;worklist&quot;);
		},
		/* =========================================================== */
		/* internal methods                                            */
		/* =========================================================== */
		/**
		 * Binds the view to the post path.
		 *
		 * @function
		 * @param {sap.ui.base.Event} oEvent pattern match event in route &apos;object&apos;
		 * @private
		 */
		_onPostMatched: function (oEvent) {
			var oViewModel = this.getModel(&quot;postView&quot;),
				oDataModel = this.getModel();
			this.getView().bindElement({
				path: &quot;/Posts(&apos;&quot; + oEvent.getParameter(&quot;arguments&quot;).postId + &quot;&apos;)&quot;,
				events: {
					dataRequested: function () {
						oDataModel.metadataLoaded().then(function () {
							// Busy indicator on view should only be set if metadata is loaded,
							// otherwise there may be two busy indications next to each other on the
							// screen. This happens because route matched handler already calls &apos;_bindView&apos;
							// while metadata is loaded.
							oViewModel.setProperty(&quot;/busy&quot;, true);
						});
					},
					dataReceived: function () {
						oViewModel.setProperty(&quot;/busy&quot;, false);
					}
				}
			});
		}
	});
});</span></pre>
<p class="p">The controller of the <samp class="ph codeph">Post</samp> page needs to take care of the data
binding when a navigation event has happened. In the <samp class="ph codeph">init</samp> function
of the controller we define a local view model and attach to the
<samp class="ph codeph">routing</samp> event. When the <samp class="ph codeph">routing</samp> event is
triggered, we bind the view to the post with the specified ID.</p>
</section></div>
</div><div class="related-links"> <div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/291c9121e6044ab381e0b51716f97f52.html" title="In this tutorial we will test application functionality with the testing tools that are delivered with OpenUI5. At different steps of this tutorial you will write tests using QUnit, OPA5, and the mock server. Additionally, you will learn about testing strategies, Test Driven Development (TDD), and much more." target="_top">Testing</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/10592affce3e4f1ba73c3125ee06e0b7.html" title="So far, we have a list of posts on the home page of the app. But typically, a post comes with more details that should be displayed on a separate detail page. We call it the post page because it displays details of a post. In this step we will introduce a new journey to test the post page. We write tests that trigger typical navigation events with OPA. Testing navigation greatly helps in reducing manual testing efforts as it covers a lot of testing paths. It is good practice to cover every view of your application with at least one test, since OPA will check if an exception is thrown. In this way you can detect critical errors very fast." target="_top">Step 8: Testing Navigation</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/07c97a2e497d443eb6fa74bb9445ab9c.html" title="In this step, we will step back from our tests and application features that we have implemented so far and add another important piece of test code: The test suite page. A test suite can execute multiple tests and collect the results. This comes in handy for automatic tools in a continuous integration process." target="_top">Step 10: Test Suite and Automated Testing</a><br></div></div></div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>