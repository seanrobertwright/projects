<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extension for Data Aggregation</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="The OData V4 Model supports features of the OData Extension for Data Aggregation V4.0 specification."><meta name="description" content="The OData V4 Model supports features of the OData Extension for Data Aggregation V4.0 specification."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"fbe1cb5613cf4a40a841750bf813238e.html","previousTopicHref":"365bdbd737034334a38a6fef07345196.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"></div><div class="page concept  - topic-topic concept-concept " id="loio7d914317c0b64c23824bf932cc8a4ae1"><h1 class="title topictitle1" hidden>Extension for Data Aggregation</h1><div class="body conbody"><p class="shortdesc" hidden>The OData V4 Model supports features of the OData Extension for Data Aggregation V4.0
specification.</p>
<p class="p">The binding parameter <samp class="ph codeph">$$aggregation</samp> at <a class="xref" href="https://sapui5.hana.ondemand.com/#api/sap.ui.model.odata.v4.ODataModel/methods/bindList" target="_blank" alt="https://sapui5.hana.ondemand.com/#api/sap.ui.model.odata.v4.ODataModel/methods/bindList" title="https://sapui5.hana.ondemand.com/#api/sap.ui.model.odata.v4.ODataModel/methods/bindList"><samp class="ph codeph">sap.ui.model.odata.v4.ODataModel#bindList</samp></a> holds the
information needed for data aggregation. It may be changed by <a class="xref" href="https://sapui5.hana.ondemand.com/#api/sap.ui.model.odata.v4.ODataListBinding/methods/setAggregation" target="_blank" alt="https://sapui5.hana.ondemand.com/#api/sap.ui.model.odata.v4.ODataListBinding/methods/setAggregation" title="https://sapui5.hana.ondemand.com/#api/sap.ui.model.odata.v4.ODataListBinding/methods/setAggregation"><samp class="ph codeph">sap.ui.model.odata.v4.ODataListBinding#setAggregation</samp></a>.
It cannot be combined with an explicit system query option <samp class="ph codeph">$apply</samp>
because it implicitly derives <samp class="ph codeph">$apply</samp>. You can find more information
also in the <a class="extlink" href="http://help.sap.com/disclaimer?site=http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html" target="_blank" alt="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html" title="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html">OData Extension for Data Aggregation V4.0 specification<img src="themes/sap-default/img/3rd_link.png" class="link-external" alt="Information published on non-SAP site" title="Information published on non-SAP site" border="0"></a>.</p>
<p class="p">Two scenarios are supported:</p>
<ul class="ul" id="loio7d914317c0b64c23824bf932cc8a4ae1__ul_xsw_3mq_f2b">
<li class="li">
<p class="p">You can provide properties for grouping and aggregation. An appropriate system query option
<samp class="ph codeph">$apply</samp> is derived from those and the list binding still
provides a flat list of contexts (&quot;rows&quot;), but with additional aggregated
properties (&quot;columns&quot;). In addition, you can request grand total values for
aggregatable properties. In this case, an extra row appears at the beginning of
the flat list of contexts and contains the grand total values as well as empty
values for all other properties.</p>
<aside class="note sap-samplecodeblock samplecode" aria-labelledby="note_0_title"><div class="title" id="note_0_title"><strong>Sample Code</strong></div>
<p class="p"><span class="ph emphasis emphasis">Example XML View With Grand Total</span></p><pre class="pre codeblock prettyprint lang-js">&lt;table:Table fixedRowCount=&quot;1&quot;
 rows=&quot;{
  path : &apos;/BusinessPartners&apos;,
  parameters : {
   $$aggregation : {
    aggregate : {
     SalesAmountSum  : {
      grandTotal : true,
      name : &apos;SalesAmount&apos;,
      with : &apos;sap.unit_sum&apos;
     }
    },
    group : {
     Region : {}
    }
   },
   $count : true,
   $filter : &apos;SalesAmountSum gt 1000000&apos;,
   $orderby : &apos;SalesAmountSum desc&apos;
  }}&quot;&gt;
 &lt;table:Column template=&quot;Region&quot;&gt;
  &lt;Label text=&quot;Region&quot;/&gt;
 &lt;/table:Column&gt;
 &lt;table:Column hAlign=&quot;End&quot;&gt;
  &lt;Label text=&quot;Sales Amount&quot;/&gt;
  &lt;table:template&gt;
   &lt;Text text=&quot;{path : &apos;SalesAmountSum&apos;, type : &apos;sap.ui.model.odata.type.Decimal&apos;}&quot; /&gt;
  &lt;/table:template&gt;
 &lt;/table:Column&gt;
 &lt;table:Column&gt;
  &lt;Label text=&quot;Currency&quot;/&gt;
  &lt;table:template&gt;
   &lt;Text text=&quot;{path : &apos;SalesAmountSum@Analytics.AggregatedAmountCurrency&apos;,
    type : &apos;sap.ui.model.odata.type.String&apos;}&quot; /&gt;
  &lt;/table:template&gt;
 &lt;/table:Column&gt;
&lt;/table:Table&gt;</pre></aside>
</li>
<li class="li">
<p class="p">You can provide group levels to determine a hierarchy of expandable group levels in addition
to the leaf nodes determined by the <samp class="ph codeph">groupable</samp> and
<samp class="ph codeph">aggregatable</samp> properties. Only a <span class="ph emphasis emphasis">single</span>
group level is currently supported and it cannot be expanded yet. Group levels
cannot be combined with filtering or with the system query option <samp class="ph codeph">$count
: true</samp>.</p>
</li>
</ul>
<aside class="note restriction" aria-labelledby="note_1_title"><div class="title" id="note_1_title"><strong>Restriction</strong></div>
<p class="p">Multi-unit situations are not supported with data aggregation. An error is thrown if
the <samp class="ph codeph">sap.ui.model.odata.v4.ODataListBinding</samp> detects a multi-unit
situation.</p><div class="p">Given a service with groupable properties <span class="keyword parmname">G1,&#x2026;,Gn</span>, an aggregatable
property <span class="keyword parmname">A</span> with related unit property <span class="keyword parmname">U</span>.
An aggregated OData request is said to return a multi-unit situation, if the
following conditions are fulfilled for the requested aggregation levels
<span class="keyword parmname">G1,&#x2026;,Gj</span> :<ol class="ol" id="loio7d914317c0b64c23824bf932cc8a4ae1__ol_glq_g4q_f2b">
<li class="li">
<p class="p">The result contains two or more entities with identical values for the
groupable properties <span class="keyword parmname">G1,&#x2026;,Gj</span>.</p>
</li>
<li class="li">
<p class="p">The entities from <span class="ph emphasis emphasis">1.</span> have
<span class="ph emphasis emphasis">different</span> values for the unit-property
<span class="keyword parmname">U</span> and any value for <span class="keyword parmname">A</span>.</p>
</li>
</ol></div></aside>
<aside class="note restriction" aria-labelledby="note_2_title"><div class="title" id="note_2_title"><strong>Restriction</strong></div>
<p>The grand total calculation is currently only supported for the
standard aggregation functions <samp class="ph codeph">sum</samp>, <samp class="ph codeph">min</samp>, and
<samp class="ph codeph">max</samp> as well as for custom aggregates that use these functions. This
also applies to displaying subtotals of group levels.</p></aside>
<div class="section" id="loio7d914317c0b64c23824bf932cc8a4ae1__section_igs_pyd_tkb"><section class="section" type="Filtering"><h2 class="section_title" style="font-size: 1.15em;">Filtering</h2>

<p class="p">Filters are provided to the list binding as described in <a class="xref" href="../../#/topic/5338bd1f9afb45fb8b2af957c3530e8f.html" title="The OData V4 Model supports server side filtering on lists." target="_top">Filtering</a>. The
<samp class="ph codeph">Filter</samp> objects are analyzed automatically to perform the filtering before the aggregation where possible using
the <samp class="ph codeph">filter()</samp> transformation. The remaining filters, including the provided <samp class="ph codeph">$filter</samp> parameter of the
binding, are applied after the aggregation either via the system query option <samp class="ph codeph">$filter</samp> or within the system query
option <samp class="ph codeph">$apply</samp>, using again the <samp class="ph codeph">filter()</samp> transformation.</p>
</section></div>
</div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>