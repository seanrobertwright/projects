<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Step 12: Make a Search Bookmarkable</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="In this step we will make the search bookmarkable. This allows users to search for employees in the Employees table and they can bookmark their search query or share the URL."><meta name="description" content="In this step we will make the search bookmarkable. This allows users to search for employees in the Employees table and they can bookmark their search query or share the URL."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"39759878ae4f48dcad0cf34da1d299f0.html","previousTopicHref":"b01840ec42ef48e6bfd2bc12612f501f.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"><div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/1b6dcd39a6a74f528b27ddb22f15af0d.html" title="OpenUI5 comes with a powerful routing API that helps you control the state of your application efficiently. This tutorial will illustrate all major features and APIs related to navigation and routing in OpenUI5 apps by creating a simple and easy to understand mobile app. It represents a set of best practices for applying the navigation and routing features of OpenUI5 to your applications." target="_top">Navigation and Routing</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/b01840ec42ef48e6bfd2bc12612f501f.html" title="In this step, we will add a new button to the home page to illustrate the usage of multiple targets for a route. When the button is pressed, a new page opens that contains two parts: a header part at the top and a content part. The content part displays a table of employees that can be sorted and searched. We will use the array notation in the routing configuration to assign multiple targets to a route - a feature that we have not yet introduced." target="_top">Step 11: Assign Multiple Targets</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/39759878ae4f48dcad0cf34da1d299f0.html" title="In this step, we will create a button at the top of the table which will change the sorting of the table. When the current sorting state of the table is changed, the sorting state will be reflected in the URL. This illustrates how to make the table sorting bookmarkable." target="_top">Step 13: Make Table Sorting Bookmarkable</a><br></div></div></div><div class="page concept  - topic-topic concept-concept " id="loioe85da535ea19430a90c381f3c2bd748e"><h1 class="title topictitle1" hidden>Step 12: Make a Search Bookmarkable</h1><div class="body conbody"><p class="shortdesc" hidden>In this step we will make the search bookmarkable. This allows users to search for
employees in the <span class="ph uicontrol">Employees</span> table and they can bookmark their search
query or share the URL.</p>
<div class="section"><section class="section" type="Preview"><h2 class="section_title" style="font-size: 1.15em;">Preview</h2>

<div class="fig fignone" id="loioe85da535ea19430a90c381f3c2bd748e__fig_r1j_pst_mr"><div class="figbody">

<img class="inline" id="loioe85da535ea19430a90c381f3c2bd748e__image_nsr_scw_zs" src="loiofeb2ddddf2e347e9893512419fe11355_LowRes.png">
</div><span class="figcap">Search and sorting bookmarkable</span></div>
</section></div>
<div class="section"><section class="section" type="Coding"><h2 class="section_title" style="font-size: 1.15em;">Coding</h2>

<p class="p">You can view and download all files in the <span class="ph uicontrol">Samples</span> in the Demo Kit
<span class="ph">at <a class="xref" href="../../#/sample/sap.ui.core.tutorial.navigation.12/preview" target="_top" alt="#/sample/sap.ui.core.tutorial.navigation.12/preview" title="#/sample/sap.ui.core.tutorial.navigation.12/preview">Routing and Navigation - Step 12</a></span>
.</p>
</section></div>
<div class="section"><section class="section" type="webapp/manifest.json"><h2 class="section_title" style="font-size: 1.15em;">webapp/manifest.json</h2>

<pre class="pre codeblock prettyprint lang-js">{
	&quot;_version&quot;: &quot;1.12.0&quot;,
	&quot;sap.app&quot;: {
		...
	},
	&quot;sap.ui&quot;: {
		...
	},
	&quot;sap.ui5&quot;: {
		...
		&quot;routing&quot;: {
			&quot;config&quot;: {
				&quot;routerClass&quot;: &quot;sap.m.routing.Router&quot;,
				&quot;viewType&quot;: &quot;XML&quot;,
				&quot;viewPath&quot;: &quot;sap.ui.demo.nav.view&quot;,
				&quot;controlId&quot;: &quot;app&quot;,
				&quot;controlAggregation&quot;: &quot;pages&quot;,
				&quot;transition&quot;: &quot;slide&quot;,
				&quot;bypassed&quot;: {
					&quot;target&quot;: &quot;notFound&quot;
				}
			},
			&quot;routes&quot;: [{
				&quot;pattern&quot;: &quot;&quot;,
				&quot;name&quot;: &quot;appHome&quot;,
				&quot;target&quot;: &quot;home&quot;
			}, {
				&quot;pattern&quot;: &quot;employees&quot;,
				&quot;name&quot;: &quot;employeeList&quot;,
				&quot;target&quot;: &quot;employees&quot;
			}, {
				&quot;pattern&quot;: &quot;employees/overview<span class="ph emphasis emphasis">:?query:</span>&quot;,
				&quot;name&quot;: &quot;employeeOverview&quot;,
				&quot;target&quot;: [&quot;employeeOverviewTop&quot;, &quot;employeeOverviewContent&quot;]

			}, {
				&quot;pattern&quot;: &quot;employees/{employeeId}&quot;,
				&quot;name&quot;: &quot;employee&quot;,
				&quot;target&quot;: &quot;employee&quot;
			}, {
				&quot;pattern&quot;: &quot;employees/{employeeId}/resume:?query:&quot;,
				&quot;name&quot;: &quot;employeeResume&quot;,
				&quot;target&quot;: &quot;employeeResume&quot;
			}],
			&quot;targets&quot;: {
				...
			}
		}
	}
}</pre>
<p class="p">In order to make the search bookmarkable we have to think about how the pattern of the
corresponding route should match the bookmark. We decide to allow
<samp class="ph codeph">/#/employees/overview?search=mySearchQueryString</samp> in order to
bookmark a search. Therefore, we simply extend our routing configuration a little.
We add the optional <samp class="ph codeph">:?query:</samp> parameter to the route
<samp class="ph codeph">employeeOverview</samp>. We keep in mind that we want to use
<samp class="ph codeph">search</samp> as the URL parameter for the search term that was
entered in the search field.</p>
</section></div>
<div class="section"><section class="section" type="webapp/controller/employee/overview/EmployeeOverviewContent.controller.js"><h2 class="section_title" style="font-size: 1.15em;">webapp/controller/employee/overview/EmployeeOverviewContent.controller.js</h2>

<pre class="pre codeblock prettyprint lang-js">sap.ui.define([
	&quot;sap/ui/demo/nav/controller/BaseController&quot;,
	&quot;sap/ui/model/Filter&quot;,
	&quot;sap/ui/model/FilterOperator&quot;,
	&quot;sap/ui/model/Sorter&quot;,
	&quot;sap/m/ViewSettingsDialog&quot;,
	&quot;sap/m/ViewSettingsItem&quot;
], function(
	BaseController,
	Filter,
	FilterOperator,
	Sorter,
	ViewSettingsDialog,
	ViewSettingsItem
) {
	&quot;use strict&quot;;

	return BaseController.extend(&quot;sap.ui.demo.nav.controller.employee.overview.EmployeeOverviewContent&quot;, {

		onInit: function () {
<span class="ph emphasis emphasis">			var oRouter = this.getRouter();</span>

			this._oTable = this.byId(&quot;employeesTable&quot;);
			this._oVSD = null;
			this._sSortField = null;
			this._bSortDescending = false;
			this._aValidSortFields = [&quot;EmployeeID&quot;, &quot;FirstName&quot;, &quot;LastName&quot;];
			this._sSearchQuery = null;
<span class="ph emphasis emphasis">			this._oRouterArgs = null;
</span>

			this._initViewSettingsDialog();

<span class="ph emphasis emphasis">			// make the search bookmarkable
			oRouter.getRoute(&quot;employeeOverview&quot;).attachMatched(this._onRouteMatched, this);</span>

		},

<span class="ph emphasis emphasis">		_onRouteMatched: function (oEvent) {
			// save the current query state
			this._oRouterArgs = oEvent.getParameter(&quot;arguments&quot;);
			this._oRouterArgs[&quot;?query&quot;] = this._oRouterArgs[&quot;?query&quot;] || {};

			// search/filter via URL hash
			this._applySearchFilter(this._oRouterArgs[&quot;?query&quot;].search);
		},
</span>

		onSortButtonPressed : function (oEvent) {
			this._oVSD.open();
		},

		onSearchEmployeesTable : function (oEvent) {
<span class="ph emphasis emphasis">			var oRouter = this.getRouter();
			// update the hash with the current search term
			this._oRouterArgs[&quot;?query&quot;].search = oEvent.getSource().getValue();
			oRouter.navTo(&quot;employeeOverview&quot;, this._oRouterArgs, true /*no history*/);</span>
		},
		...
	});
});</pre>
<p class="p">Now we handle the optional query parameter from the <samp class="ph codeph">employeeOverview</samp> route in our <samp class="ph codeph">EmployeeOverviewContent</samp>
controller. First we change the <samp class="ph codeph">onInit</samp> function by adding an event listener for the matched event of the
<samp class="ph codeph">employeeOverview</samp> route. Then we buffer the current router arguments as received from the event. If a query is
available, the result from <samp class="ph codeph">oEvent.getParameter(&quot;arguments&quot;)</samp> will contain a <samp class="ph codeph">?query</samp> property with an
object of all URL parameters specified, otherwise it is undefined. If no query parameter is defined, we always initialize the query
and save it to <samp class="ph codeph">this._oRouterArgs[&quot;?query&quot;]</samp>. If we have a search term query at the <samp class="ph codeph">search</samp> key we
continue and call <samp class="ph codeph">this._applySearchFilter(this._oRouterArgs[&quot;?query&quot;].search)</samp> to trigger a search based on the search
query parameter from the URL.</p>
<p class="p">Storing the <samp class="ph codeph">arguments</samp> objects internally in the controller is important, because we will use the current arguments when calling
<samp class="ph codeph">navTo()</samp> in the search event handler <samp class="ph codeph">onSearchEmployeesTable</samp> and pass on the arguments with the
updated search term. We keep the URL and the UI in sync by navigating to the current target again with the current value of the search
field from the event&#x2019;s source. The search value is stored in <samp class="ph codeph">this._oRouterArgs[&quot;?query&quot;].search</samp> together with the
other query parameters and it is passed directly to the router again</p>
<div class="p">That&#x2019;s it, now our search is bookmarkable and reflected in the URL. Try to access the
following pages in your browser:<ul class="ul" id="loioe85da535ea19430a90c381f3c2bd748e__ul_ovj_fsv_ns">
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/overview</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/overview?search=</samp></p>
</li>
<li class="li">
<p class="p"><samp class="ph codeph">webapp/index.html#/employees/overview?search=an</samp></p>
</li>
</ul>When you change the value in the search field, you see that the hash updates
accordingly.</div>
</section></div>
</div><div class="related-links"> <div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/1b6dcd39a6a74f528b27ddb22f15af0d.html" title="OpenUI5 comes with a powerful routing API that helps you control the state of your application efficiently. This tutorial will illustrate all major features and APIs related to navigation and routing in OpenUI5 apps by creating a simple and easy to understand mobile app. It represents a set of best practices for applying the navigation and routing features of OpenUI5 to your applications." target="_top">Navigation and Routing</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/b01840ec42ef48e6bfd2bc12612f501f.html" title="In this step, we will add a new button to the home page to illustrate the usage of multiple targets for a route. When the button is pressed, a new page opens that contains two parts: a header part at the top and a content part. The content part displays a table of employees that can be sorted and searched. We will use the array notation in the routing configuration to assign multiple targets to a route - a feature that we have not yet introduced." target="_top">Step 11: Assign Multiple Targets</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/39759878ae4f48dcad0cf34da1d299f0.html" title="In this step, we will create a button at the top of the table which will change the sorting of the table. When the current sorting state of the table is changed, the sorting state will be reflected in the URL. This illustrates how to make the table sorting bookmarkable." target="_top">Step 13: Make Table Sorting Bookmarkable</a><br></div></div></div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>