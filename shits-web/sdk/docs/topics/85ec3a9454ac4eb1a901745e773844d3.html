<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Step 4: Quick Filter for the Worklist</title><link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="themes/sap-default/img/favicon.ico"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="abstract" content="For easily detecting and managing product shortages in our app, we will add a quick filter for the worklist table. Users can press the filter tabs to display the products according to whether they are in stock, have low stock or no stock. The table will update accordingly and show only the products matching the criteria."><meta name="description" content="For easily detecting and managing product shortages in our app, we will add a quick filter for the worklist table. Users can press the filter tabs to display the products according to whether they are in stock, have low stock or no stock. The table will update accordingly and show only the products matching the criteria."><meta name="content category" content="development"><script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"2da220ff496c4b0f9ce29208cbd089f3.html","previousTopicHref":"84100bcfd5b34f62858bdd6f67976b4a.html"}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="toc-info.js"></script><script type="text/javascript" src="themes/sap-default/js/script.js"></script>
		<!--[if lt IE 9]>
			<script>
			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
			    "progress,section,time,video").split(',');
			  for (var i = 0; i < e.length; i++) {
			    document.createElement(e[i]);
			  }
			</script>
		<![endif]-->
        
    <script>
      function addLoadEvent(func) {
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {
          window.onload = func;
        } else {
          window.onload = function() {
            if (oldonload) {
              oldonload();
        }
        func();
       }
     }
     }
      
    addLoadEvent(function() { prettyPrint();
if ($('#local-navigation').length) {
        $('#local-navigation').navigation();
    }


});
      
    </script>
     <script type="text/javascript" src="js/prettify.js"> </script><script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script><script>function handleAreaClick(oArea) {window.parent.location.href = oArea.href;}</script><link type="text/css" rel="stylesheet" href="css/overrides.css"></head><body class="en-us sap-default centered navigation-default toc-injection enumeration-disabled" style="font-family: &apos;72&apos;, Arial, Helvetica, sans-serif;"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer-container">Skip to footer</a></li></ul><div id="d4h5-section-container" class="grid_12" style="padding-top: 0;"><div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;"><section><div id="content-toolbar" class="toolbar hide-for-small"><div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/6a6a621c978145ad9eef2b221d2cf21d.html" title="In this tutorial we will build an app using OpenUI5 that, for example, a shop owner can use to manage his product stock levels." target="_top">Worklist App</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/84100bcfd5b34f62858bdd6f67976b4a.html" title="In this step, we will edit the worklist table to include additional columns for our manage product stocks scenario. We display the supplier, the product price, and the number of units on order for each product and format the values accordingly." target="_top">Step 3: Extending the Worklist Table</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/2da220ff496c4b0f9ce29208cbd089f3.html" title="Now we can easily spot shortages on our stock, but we would also like to take action and resolve it. Either we can decide to remove the product until the shortage is resolved or order new items of the product. In this step, we will add these actions to the footer of the worklist table." target="_top">Step 5: Adding Actions to the Worklist</a><br></div></div></div><div class="page concept  - topic-topic concept-concept " id="loio85ec3a9454ac4eb1a901745e773844d3"><h1 class="title topictitle1" hidden>Step 4: Quick Filter for the Worklist</h1><div class="body conbody"><p class="shortdesc" hidden>For easily detecting and managing product shortages in our app, we will add a quick
filter for the worklist table. Users can press the filter tabs to display the products
according to whether they are in stock, have low stock or no stock. The table will update
accordingly and show only the products matching the criteria.</p>
<div class="section"><section class="section" type="Preview"><h2 class="section_title" style="font-size: 1.15em;">Preview</h2>

<div class="fig fignone" id="loio85ec3a9454ac4eb1a901745e773844d3__fig_nmv_yrs_c5"><div class="figbody">

<img class="inline" id="loio85ec3a9454ac4eb1a901745e773844d3__image_kxn_2z1_tdb" src="loio395f8acac5fd4fbc9a1c52c615fa07d3_LowRes.jpg">
</div><span class="figcap">A quick filter allows filtering the product table</span></div>
</section></div>
<div class="section"><section class="section" type="Coding"><h2 class="section_title" style="font-size: 1.15em;">Coding</h2>

<p class="p">You can view and download all files in the Demo Kit <span class="ph">at <a class="xref" href="../../#/sample/sap.m.tutorial.worklist.04/preview" target="_top" alt="#/sample/sap.m.tutorial.worklist.04/preview" title="#/sample/sap.m.tutorial.worklist.04/preview">Worklist App - Step 4</a></span>.</p>
<div class="sectiondiv subsection">
<p class="p subsectiontitle">webapp/view/Worklist.view.xml</p>
<pre class="pre codeblock prettyprint lang-xml">&lt;mvc:View
	controllerName=&quot;myCompany.myApp.controller.Worklist&quot;
	xmlns:mvc=&quot;sap.ui.core.mvc&quot;
	xmlns:semantic=&quot;sap.m.semantic&quot;
	xmlns=&quot;sap.m&quot;&gt;
	&lt;semantic:FullscreenPage
		id=&quot;page&quot;
		navButtonPress=&quot;onNavBack&quot;
		showNavButton=&quot;true&quot;
		title=&quot;{i18n&gt;worklistViewTitle}&quot;&gt;
		&lt;semantic:content&gt;
<span class="ph emphasis emphasis">			&lt;IconTabBar
				id=&quot;iconTabBar&quot;
				select=&quot;.onQuickFilter&quot;
				expandable=&quot;false&quot;
				headerBackgroundDesign=&quot;Transparent&quot;&gt;
				&lt;items&gt;
					&lt;IconTabFilter
						key=&quot;all&quot;
						showAll=&quot;true&quot;
						count=&quot;{worklistView&gt;/countAll}&quot;
						text=&quot;{i18n&gt;WorklistFilterProductsAll}&quot;/&gt;
					&lt;IconTabSeparator/&gt;
					&lt;IconTabFilter
						key=&quot;inStock&quot;
						icon=&quot;sap-icon://message-success&quot;
						iconColor=&quot;Positive&quot;
						count=&quot;{worklistView&gt;/inStock}&quot;
						text=&quot;{i18n&gt;WorklistFilterInStock}&quot;/&gt;
					&lt;IconTabFilter
						key=&quot;shortage&quot;
						icon=&quot;sap-icon://message-warning&quot;
						iconColor=&quot;Critical&quot;
						count=&quot;{worklistView&gt;/shortage}&quot;
						text=&quot;{i18n&gt;WorklistFilterShortage}&quot;/&gt;
					&lt;IconTabFilter
						key=&quot;outOfStock&quot;
						icon=&quot;sap-icon://message-error&quot;
						iconColor=&quot;Negative&quot;
						count=&quot;{worklistView&gt;/outOfStock}&quot;
						text=&quot;{i18n&gt;WorklistFilterOutOfStock}&quot;/&gt;
				&lt;/items&gt;
				&lt;content&gt;</span>
					&lt;Table
...
					&lt;/Table&gt;
<span class="ph emphasis emphasis">				&lt;/content&gt;
			&lt;/IconTabBar&gt;
</span>

		&lt;/semantic:content&gt;
		&lt;semantic:sendEmailAction&gt;
			&lt;semantic:SendEmailAction
				id=&quot;shareEmail&quot;
				press=&quot;onShareEmailPress&quot;/&gt;
		&lt;/semantic:sendEmailAction&gt;
	&lt;/semantic:FullscreenPage&gt;
&lt;/mvc:View&gt;
</pre>
<div class="p">We now update the view and add the new UI for the quick filter to the content aggregation of the
<samp class="ph codeph">sap.m.SemanticPage</samp> control just before the <samp class="ph codeph">table</samp>. It is modeled using a
<samp class="ph codeph">sap.m.IconTabBar</samp> control and a <samp class="ph codeph">sap.m.IconTabFilter</samp> for each of the following filter options:
<ul class="ul" id="loio85ec3a9454ac4eb1a901745e773844d3__ul_rv2_35s_c5">
<li class="li">
<p class="p"><span class="ph uicontrol">Total Stock</span></p>
<p class="p">This tab will simply show the overall number of products that has been returned by the data service. The
<samp class="ph codeph">count</samp> property is bound to a local view model and the number will be updated in the controller
later in this step. This tab will show a larger number only (optional) and no icon by using the
<samp class="ph codeph">showAll</samp> property.</p>
</li>
<li class="li">
<p class="p"><span class="ph uicontrol">Out of Stock</span></p>
<p class="p">This tab will show all the products that are out of stock. We choose a matching icon from the icon font and set the
icon color to the semantic <samp class="ph codeph">Negative</samp> state so that it will appear in red.</p>
</li>
<li class="li">
<p class="p"><span class="ph uicontrol">Shortage</span></p>
<p class="p">This tab will show products that have less than 10 pieces remaining with a semantic <samp class="ph codeph">Critical</samp> state
that will make the icon appear in orange. The count of the number of low stock products will be displayed on the tab
and the icon will appear in orange. </p>
</li>
<li class="li">
<p class="p"><span class="ph uicontrol">Plenty in Stock</span></p>
<div class="p">This tab will show products that have more than 10 pieces in stock. The semantic <samp class="ph codeph">Positive</samp> state will
let the icon appear in green. As usual the UI texts for the tabs are linked to the resource bundle file and will be
added later. Do not forget to set the standard CSS class <samp class="ph codeph">sapUiNoMarginTop</samp> on the table to remove the
spacing between the <samp class="ph codeph">IconTabBar</samp> and the <samp class="ph codeph">table</samp> and make the UI look nicer. <aside class="note" aria-labelledby="note_0_title"><div class="title" id="note_0_title"><strong>Note</strong></div>
<p class="p">Each <samp class="ph codeph">IconTabFilter</samp> element has a <samp class="ph codeph">key</samp> property that is used to identify the
tab that was pressed in the event handler <samp class="ph codeph">onQuickFilter</samp> that is registered on the
<samp class="ph codeph">IconTabBar</samp> control directly. The event handler implementation does the actual filtering
on the table and is defined in the controller.</p></aside></div>
</li>
</ul>
</div>
</div>
<div class="sectiondiv subsection">
<p class="p subsectiontitle">webapp/controller/Worklist.controller.js</p>
<pre class="pre codeblock prettyprint lang-js">...
onInit: function() {
	var oViewModel,
		iOriginalBusyDelay,
		oTable = this.byId(&quot;table&quot;);

	// Put down worklist table&apos;s original value for busy indicator delay,
	// so it can be restored later on. Busy handling on the table is
	// taken care of by the table itself.
	iOriginalBusyDelay = oTable.getBusyIndicatorDelay();
	<span class="ph emphasis emphasis">this._oTable = oTable;</span>
	// keeps the search state
	this._oTableSearchState = [];
	// Model used to manipulate control states
	oViewModel = new JSONModel({
		worklistTableTitle: this.getResourceBundle().getText(&quot;worklistTableTitle&quot;),
		shareOnJamTitle: this.getResourceBundle().getText(&quot;worklistTitle&quot;),
		shareSendEmailSubject: this.getResourceBundle().getText(&quot;shareSendEmailWorklistSubject&quot;),
		shareSendEmailMessage: this.getResourceBundle().getText(&quot;shareSendEmailWorklistMessage&quot;, [location.href]),
		tableNoDataText: this.getResourceBundle().getText(&quot;tableNoDataText&quot;),
		tableBusyDelay: 0<span class="ph emphasis emphasis">,
		inStock: 0,
		shortage: 0,
		outOfStock: 0,
		countAll: 0
</span>
	});
	this.setModel(oViewModel, &quot;worklistView&quot;);
	<span class="ph emphasis emphasis">// Create an object of filters
	this._mFilters = {
		&quot;inStock&quot;: [new Filter(&quot;UnitsInStock&quot;, &quot;GT&quot;, 10)],
		&quot;outOfStock&quot;: [new Filter(&quot;UnitsInStock&quot;, &quot;LE&quot;, 0)],
		&quot;shortage&quot;: [new Filter(&quot;UnitsInStock&quot;, &quot;BT&quot;, 1, 10)],
		&quot;all&quot;: []
	};
</span>
	// Make sure, busy indication is showing immediately so there is no
	// break after the busy indication for loading the view&apos;s meta data is
	// ended (see promise &apos;oWhenMetadataIsLoaded&apos; in AppController)
	oTable.attachEventOnce(&quot;updateFinished&quot;, function() {
		// Restore original busy indicator delay for worklist&apos;s table
		oViewModel.setProperty(&quot;/tableBusyDelay&quot;, iOriginalBusyDelay);
	});
},
...</pre>
<p class="p">As a preparation step for the filter tabs we add properties for the counters into the local view model of the worklist controller.
We initialize the four values with <samp class="ph codeph">0</samp> each. Furthermore, we create an object <samp class="ph codeph">_mFilters</samp> that
contains a filter for each tab. We will use the filters for filtering the table below the tabs. The properties in
<samp class="ph codeph">_mFilters</samp> correlate to the keys of the <samp class="ph codeph">IconTabFilter</samp> controls we defined above in the
<span class="ph filepath">Worklist.view.xml</span> file. This way we can easily access a filter for a given tab based on the key of the
corresponding tab.</p>
<p class="p"> Creating a simple filter requires a binding path as first parameter of the filter constructor (e.g. <samp class="ph codeph">&quot;UnitsInStock&quot;</samp>), a filter
operator (e.g. <samp class="ph codeph">&quot;GT&quot;</samp>) as second argument, and a value to compare (e.g. <samp class="ph codeph">10</samp>) as the third argument.
We create such filters for all three tabs with different filter operators as described in the view part above. Additionally, we
create an <samp class="ph codeph">all</samp> filter, which is an empty array for clearing the binding again (when the user chooses the
<span class="ph uicontrol">All</span> tab).</p>
</div>
<div class="sectiondiv subsection">
<p class="p subsectiontitle">webapp/controller/Worklist.controller.js</p>
<pre class="pre codeblock prettyprint lang-js">...
onUpdateFinished: function(oEvent) {
	// update the worklist&apos;s object counter after the table update
	var sTitle,
		oTable = oEvent.getSource(),
		<span class="ph emphasis emphasis">oViewModel = this.getModel(&quot;worklistView&quot;),
</span>
		iTotalItems = oEvent.getParameter(&quot;total&quot;);
	// only update the counter if the length is final and
	// the table is not empty
	<span class="ph emphasis emphasis">if (iTotalItems &amp;</span>&amp; oTable.getBinding(&quot;items&quot;).isLengthFinal()) {
		sTitle = this.getResourceBundle().getText(&quot;worklistTableTitleCount&quot;, [iTotalItems]);	 
		<span class="ph emphasis emphasis">// Get the count for all the products and set the value to &apos;countAll&apos; property
		this.getModel().read(&quot;/Products/$count&quot;, {
			success: function (oData) {
				oViewModel.setProperty(&quot;/countAll&quot;, oData);
			}
		});
		// read the count for the unitsInStock filter
		this.getModel().read(&quot;/Products/$count&quot;, {
			success: function (oData) {
				oViewModel.setProperty(&quot;/inStock&quot;, oData);
			},
			filters: this._mFilters.inStock
		});
		// read the count for the outOfStock filter
		this.getModel().read(&quot;/Products/$count&quot;, {
			success: function(oData){
				oViewModel.setProperty(&quot;/outOfStock&quot;, oData);
			},
			filters: this._mFilters.outOfStock
		});  
		// read the count for the shortage filter
		this.getModel().read(&quot;/Products/$count&quot;, { 
			success: function(oData){
				oViewModel.setProperty(&quot;/shortage&quot;, oData);
			},
			filters: this._mFilters.shortage
		});</span>	  
	} else {
		sTitle = this.getResourceBundle().getText(&quot;worklistTableTitle&quot;);
	}
	this.getModel(&quot;worklistView&quot;).setProperty(&quot;/worklistTableTitle&quot;, sTitle);
},
...</pre>
<div class="p">In the <samp class="ph codeph">onUpdateFinished</samp> function, we get the count of all products by triggering a read operation on the model
with the appropriate filter. The filter is a helper object of <span class="ph"><span class="ph pname">OpenUI5</span></span>
that defines the condition for each tab on the data binding level. We already created the filters in the <samp class="ph codeph">onInit</samp>
function. <aside class="note" aria-labelledby="note_1_title"><div class="title" id="note_1_title"><strong>Note</strong></div>
<p class="p">The<samp class="ph codeph"> v2.ODataModel</samp> will automatically bundle these <samp class="ph codeph">read</samp> requests to one batch request to
the server (if batch mode is enabled).</p></aside> In the <samp class="ph codeph">success</samp> handler of each <samp class="ph codeph">read</samp> operation we update the corresponding property in
the view model with the real count of the matching items that were returned by the service.</div>
</div>
<div class="sectiondiv subsection">
<p class="p subsectiontitle">webapp/controller/Worklist.controller.js</p>
<pre class="pre codeblock prettyprint lang-js">...
_applySearch: function(oTableSearchState) {
	...
}<span class="ph emphasis emphasis">,
/**
 * Event handler when a filter tab gets pressed
 * @param {sap.ui.base.Event} oEvent the filter tab event
 * @public
 */
onQuickFilter: function(oEvent) {
	var oBinding = this._oTable.getBinding(&quot;items&quot;),
		sKey = oEvent.getParameter(&quot;selectedKey&quot;);
	oBinding.filter(this._mFilters[sKey]);
}
</span>
...
</pre>
<p class="p">Next, we implement the handler for the <samp class="ph codeph">select</samp> event of the <samp class="ph codeph">IconTabBar</samp>. In this event handler we get a
reference to the binding for the <samp class="ph codeph">items</samp> aggregation of our <samp class="ph codeph">table</samp> and store it in the variable
<samp class="ph codeph">oBinding</samp>. Then we read the parameter <samp class="ph codeph">selectedKey</samp> from the <samp class="ph codeph">event</samp> object to
find out which tab has been selected. This <samp class="ph codeph">selectedKey</samp> is used to get the correct filter for the selected tab.
Next, we simply call the filter method on <samp class="ph codeph">oBinding</samp> and pass the correct filter of the selected tab.</p>
<p class="p">The filters are always applied as an array on the binding level, so you don&apos;t need to take care of managing the data, the data
binding features of <span class="ph"><span class="ph pname">OpenUI5</span></span> will automatically take care.</p>
</div>
<div class="sectiondiv subsection">
<p class="p subsectiontitle">webapp/i18n/i18n.properties</p>
<pre class="pre codeblock prettyprint lang-prefs">
...

<span class="ph emphasis emphasis">
#XTIT: The title of the products quick filter
WorklistFilterProductsAll=Products

#XTIT: The title of the out of stock products filter
WorklistFilterOutOfStock=Out of Stock

#XTIT: The title of the low stock products filter
WorklistFilterShortage=Shortage

#XTIT: The title of the products in stock filter
WorklistFilterInStock=Plenty in Stock
</span>

#~~~ Object View ~~~~~~~~~~~~~~~~~~~~~~~~~~
...</pre>
<p class="p">We finally add the texts for the tab filters to the resource bundle. Copy the text definitions from the code section above to the
end of the <samp class="ph codeph">Worklistn View</samp> section in the i18n file.</p>
<p class="p">Now run the app again and click the filter icons on top of the table. The products should be filtered according to the selection in the filter
bar and the count should match the number of items displayed.</p>
</div>
</section></div>
</div><div class="related-links"> <div class="familylinks"><div class="parentlink"><br><strong>Parent topic: </strong><a class="link" href="../../#/topic/6a6a621c978145ad9eef2b221d2cf21d.html" title="In this tutorial we will build an app using OpenUI5 that, for example, a shop owner can use to manage his product stock levels." target="_top">Worklist App</a><br></div><div class="previouslink"><br><strong>Previous: </strong><a class="link" href="../../#/topic/84100bcfd5b34f62858bdd6f67976b4a.html" title="In this step, we will edit the worklist table to include additional columns for our manage product stocks scenario. We display the supplier, the product price, and the number of units on order for each product and format the values accordingly." target="_top">Step 3: Extending the Worklist Table</a><br></div><div class="nextlink"><br><strong>Next: </strong><a class="link" href="../../#/topic/2da220ff496c4b0f9ce29208cbd089f3.html" title="Now we can easily spot shortages on our stock, but we would also like to take action and resolve it. Either we can decide to remove the product until the shortage is resolved or order new items of the product. In this step, we will add these actions to the footer of the worklist table." target="_top">Step 5: Adding Actions to the Worklist</a><br></div></div><div class="relinfo"><div class="relinfotitle ">Related Information</div><div><a class="link" href="../../#/api/sap.ui.model.ListBinding" target="_top" alt="#/api/sap.ui.model.ListBinding" title="#/api/sap.ui.model.ListBinding">API Reference: <samp class="ph codeph">sap.ui.model.ListBinding.filter </samp></a></div></div></div></div></section><div class="clear"></div>
</div><div class="clearfix"></div></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"><footer>
	<div id="custom-footerSpacer"></div>
	
</footer>
</div></body></html>